<!DOCTYPE html>
<!-- saved from url=(0040)http://www.imooc.com/read/47/article/847 -->
<html style="user-select: auto !important"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>05 ArrayList 源码解析和设计思路   -慕课专栏</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="renderer" content="webkit">

<meta property="qc:admins" content="77103107776157736375">
<meta property="wb:webmaster" content="c4f857219bfae3cb">
<meta http-equiv="Access-Control-Allow-Origin" content="*">
<meta http-equiv="Cache-Control" content="no-transform ">
<meta http-equiv="Cache-Control" content="no-siteapp">
<link rel="dns-prefetch" href="http://www.imooc.com/">
<link rel="dns-prefetch" href="http://img.imooc.com/">
<link rel="dns-prefetch" href="http://img1.sycdn.imooc.com/">
<link rel="apple-touch-icon" sizes="76x76" href="http://www.imooc.com/static/img/common/touch-icon-ipad.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://www.imooc.com/static/img/common/touch-icon-iphone-retina.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://www.imooc.com/static/img/common/touch-icon-ipad-retina.png">


<meta name="description" content="引导语 ArrayList 我们几乎每天都会使用到，但真正面试的时候，发现还是有不少人对源码细节说不清楚，给面试官留下比较差的印象，本小节就和大家一起看看面试中和 ArrayList 相关的源码。 1 整体架构 ArrayList 整体架构比较简单，就是一个数组结构，比较简单，如下图： 图中展...">







<link href="./1_files/captcha.min.css" rel="stylesheet">



<link rel="stylesheet" href="./1_files/moco.min.css" type="text/css">
<link rel="stylesheet" href="./1_files/swiper-3.4.2.min.css">




<script src="./1_files/push.js"></script><script type="text/javascript" async="" src="./1_files/rt.js"></script><script src="./1_files/hm.js"></script><script async="" type="text/javascript" id="zhuge-js" src="./1_files/zhuge.min.js"></script><script type="text/javascript">

var OP_CONFIG={"module":"read","page":"chapter","userInfo":{"uid":4119986,"uidaes":"RHKLkaHfEiA,"}};
var isLogin = 1;
var is_choice = "";
var seajsTimestamp="v=202003231410";
var _msg_unread = 0; 
var _not_unread = 0; 
var _cart_num = 0;
var ownName="919079498@qq.com"
</script><style type="text/css" abt="234"></style>




<script type="text/javascript" src="./1_files/youziku.api.min.js"></script><style type="text/css">@font-face {font-family: 'SourceHanSerif-1b72d0cb661f2cf';src: url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47753/5d63c063344aa54d197c5357.gif');src: url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47753/5d63c063344aa54d197c5357.gif?#iefix') format('embedded-opentype'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47753/5d63c063344aa54d197c5357.png') format('woff2'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47753/5d63c063344aa54d197c5357.bmp') format('woff'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47753/5d63c063344aa54d197c5357.jpg') format('truetype');font-weight: normal;font-style: normal;}</style><style type="text/css">.art-title, .cl-preview-section h1,.cl-preview-section h2,.cl-preview-section h3,.cl-preview-section h4,.cl-preview-section h5,.cl-preview-section h6{font-family:'SourceHanSerif-1b72d0cb661f2cf'  !important; }</style><style type="text/css">@font-face {font-family: 'SourceHan-S-SC18d5319bbc1f2cf';src: url('//cdn.webfont.youziku.com/webfonts/vipjs/127695/47568/5cb8540d344aa504e8913e0f.gif');src: url('//cdn.webfont.youziku.com/webfonts/vipjs/127695/47568/5cb8540d344aa504e8913e0f.gif?#iefix') format('embedded-opentype'),url('//cdn.webfont.youziku.com/webfonts/vipjs/127695/47568/5cb8540d344aa504e8913e0f.png') format('woff2'),url('//cdn.webfont.youziku.com/webfonts/vipjs/127695/47568/5cb8540d344aa504e8913e0f.bmp') format('woff'),url('//cdn.webfont.youziku.com/webfonts/vipjs/127695/47568/5cb8540d344aa504e8913e0f.jpg') format('truetype');font-weight: normal;font-style: normal;}</style><style type="text/css">.famous-word,.lead-motto, .cl-preview-section blockquote{font-family:'SourceHan-S-SC18d5319bbc1f2cf'  !important; }</style><style type="text/css">@font-face {font-family: 'HYQiHei-55S1ba010691e1f2cf';src: url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47788/5d6f55ca344aa779c00a0edd.gif');src: url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47788/5d6f55ca344aa779c00a0edd.gif?#iefix') format('embedded-opentype'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47788/5d6f55ca344aa779c00a0edd.png') format('woff2'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47788/5d6f55ca344aa779c00a0edd.bmp') format('woff'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47788/5d6f55ca344aa779c00a0edd.jpg') format('truetype');font-weight: normal;font-style: normal;}</style><style type="text/css">#article_content,.cl-preview-section ul,.cl-preview-section ol,.cl-preview-section p, .cl-preview-section pre, .cl-preview-section code, #code-copy{font-family:'HYQiHei-55S1ba010691e1f2cf'  !important; }</style><style type="text/css">@font-face {font-family: 'HYQiHei-70J1b71b093b61f2cf';src: url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47481/5d63769a344aa7285fb9681c.gif');src: url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47481/5d63769a344aa7285fb9681c.gif?#iefix') format('embedded-opentype'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47481/5d63769a344aa7285fb9681c.png') format('woff2'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47481/5d63769a344aa7285fb9681c.bmp') format('woff'),url('//cdn.repository.webfont.com/webfonts/vipjs/127695/47481/5d63769a344aa7285fb9681c.jpg') format('truetype');font-weight: normal;font-style: normal;}</style><style type="text/css">.cl-preview-section strong{font-family:'HYQiHei-70J1b71b093b61f2cf'  !important; }</style>
<script type="text/javascript">
$youziku.load(".art-title, .cl-preview-section h1,.cl-preview-section h2,.cl-preview-section h3,.cl-preview-section h4,.cl-preview-section h5,.cl-preview-section h6", "37af461390fa4d138f5c3d277f7286dc", "SourceHanSerifSC-Heavy"); // 思源宋体heavy
$youziku.load(".famous-word,.lead-motto, .cl-preview-section blockquote", "d9a0d855583142c3b2cc3bf1646a8473", "SourceHanSerifSC-Regular"); // 思源宋体regular
$youziku.load("#article_content,.cl-preview-section ul,.cl-preview-section ol,.cl-preview-section p, .cl-preview-section pre, .cl-preview-section code, #code-copy", "3d84aabcf9e44b6f8c6fa91c61fa926e", "HYQiHei-55S"); // 汉仪旗黑55s
$youziku.load(".cl-preview-section strong", "fd94fff3a17546a28913a79613bddcec", "HYQiHei-77S"); // 汉仪旗黑70s

$youziku.draw();
</script>
<script>
    // 为html转码，article_content 为新markdown编辑器接收的初始化内容
    var article_content = "&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h2 id=&quot;引导语&quot;&gt;引导语&lt;/h2&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;ArrayList 我们几乎每天都会使用到，但真正面试的时候，发现还是有不少人对源码细节说不清楚，给面试官留下比较差的印象，本小节就和大家一起看看面试中和 ArrayList 相关的源码。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h2 id=&quot;整体架构&quot;&gt;1 整体架构&lt;/h2&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;ArrayList 整体架构比较简单，就是一个数组结构，比较简单，如下图：&lt;br&gt;\n&lt;img src=&quot;//img1.sycdn.imooc.com/5d5fc5f80001e20e15080238.png&quot; alt=&quot;图片描述&quot;&gt;图中展示是长度为 10 的数组，从 1 开始计数，index 表示数组的下标，从 0 开始计数，elementData 表示数组本身，源码中除了这两个概念，还有以下三个基本概念：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;DEFAULT_CAPACITY 表示数组的初始大小，默认是 10，这个数字要记住；&lt;/li&gt;\n&lt;li&gt;size 表示当前数组的大小，类型 int，没有使用 volatile 修饰，非线程安全的；&lt;/li&gt;\n&lt;li&gt;modCount 统计当前数组被修改的版本次数，数组结构有变动，就会 +1。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;&lt;strong&gt;类注释&lt;/strong&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;看源码，首先要看类注释，我们看看类注释上面都说了什么，如下：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;允许 put null 值，会自动扩容；&lt;/li&gt;\n&lt;li&gt;size、isEmpty、get、set、add 等方法时间复杂度都是 O (1)；&lt;/li&gt;\n&lt;li&gt;是非线程安全的，多线程情况下，推荐使用线程安全类：Collections#synchronizedList；&lt;/li&gt;\n&lt;li&gt;增强 for 循环，或者使用迭代器迭代过程中，如果数组大小被改变，会快速失败，抛出异常。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;除了上述注释中提到的 4 点，初始化、扩容的本质、迭代器等问题也经常被问，接下来我们从源码出发，一一解析。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h2 id=&quot;源码解析&quot;&gt;2 源码解析&lt;/h2&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;初始化&quot;&gt;2.1 初始化&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;我们有三种初始化办法：无参数直接初始化、指定大小初始化、指定初始数据初始化，源码如下：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; DEFAULTCAPACITY_EMPTY_ELEMENTDATA &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n\n&lt;span class=&quot;token comment&quot;&gt;//无参数直接初始化，数组大小为空&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;elementData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DEFAULTCAPACITY_EMPTY_ELEMENTDATA&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n\n&lt;span class=&quot;token comment&quot;&gt;//指定初始数据初始化&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Collection&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;gt;&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;//elementData 是保存数组的容器，默认为 null&lt;/span&gt;\n    elementData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;//如果给定的集合（c）数据有值&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; elementData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n        &lt;span class=&quot;token comment&quot;&gt;// c.toArray might (incorrectly) not return Object[] (see 6260652)&lt;/span&gt;\n        &lt;span class=&quot;token comment&quot;&gt;//如果集合元素类型不是 Object 类型，我们会转成 Object&lt;/span&gt;\n        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n            elementData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Arrays&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;copyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n        &lt;span class=&quot;token comment&quot;&gt;// 给定集合（c）无值，则默认空数组&lt;/span&gt;\n        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;elementData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EMPTY_ELEMENTDATA&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;除了源码的中文注释，我们补充两点：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;1：ArrayList 无参构造器初始化时，默认大小是空数组，并不是大家常说的 10，10 是在第一次 add 的时候扩容的数组值。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;2：指定初始数据初始化时，我们发现一个这样子的注释 see 6260652，这是 Java 的一个 bug，意思是当给定集合内的元素不是 Object 类型时，我们会转化成 Object 的类型。一般情况下都不会触发此 bug，只有在下列场景下才会触发：ArrayList 初始化之后（ArrayList 元素非 Object 类型），再次调用 toArray 方法，得到 Object 数组，并且往 Object 数组赋值时，才会触发此 bug，代码和原因如图：&lt;br&gt;\n&lt;img src=&quot;//img1.sycdn.imooc.com/5d5fc6100001109518100714.png&quot; alt=&quot;图片描述&quot;&gt;官方查看文档地址：&lt;a href=&quot;https://bugs.java.com/bugdatabase/view_bug.do?bug_id=6260652%EF%BC%8C%E9%97%AE%E9%A2%98%E5%9C%A8&quot;&gt;https://bugs.java.com/bugdatabase/view_bug.do?bug_id=6260652，问题在&lt;/a&gt; Java 9 中被解决。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;新增和扩容实现&quot;&gt;2.2 新增和扩容实现&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;新增就是往数组中添加元素，主要分成两步：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;判断是否需要扩容，如果需要执行扩容操作；&lt;/li&gt;\n&lt;li&gt;直接赋值。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;两步源码体现如下：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;E e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//确保数组大小是否足够，不够执行扩容，size 为当前数组的大小&lt;/span&gt;\n  &lt;span class=&quot;token function&quot;&gt;ensureCapacityInternal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// Increments modCount!!&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//直接赋值，线程不安全的&lt;/span&gt;\n  elementData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;size&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;我们先看下扩容（ensureCapacityInternal）的源码：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ensureCapacityInternal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//如果初始化数组大小时，有给定初始值，以给定的大小为准，不走 if 逻辑&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; DEFAULTCAPACITY_EMPTY_ELEMENTDATA&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    minCapacity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;DEFAULT_CAPACITY&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//确保容积足够&lt;/span&gt;\n  &lt;span class=&quot;token function&quot;&gt;ensureExplicitCapacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ensureExplicitCapacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//记录数组被修改&lt;/span&gt;\n  modCount&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 如果我们期望的最小容量大于目前数组的长度，那么就扩容&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;minCapacity &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; elementData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;token function&quot;&gt;grow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;token comment&quot;&gt;//扩容，并把现有数据拷贝到新的数组里面去&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; oldCapacity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; elementData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// oldCapacity &amp;gt;&amp;gt; 1 是把 oldCapacity 除以 2 的意思&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; newCapacity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; oldCapacity &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;oldCapacity &lt;span class=&quot;token operator&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n\n  &lt;span class=&quot;token comment&quot;&gt;// 如果扩容后的值 &amp;lt; 我们的期望值，扩容后的值就等于我们的期望值&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;newCapacity &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; minCapacity &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    newCapacity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; minCapacity&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n\n  &lt;span class=&quot;token comment&quot;&gt;// 如果扩容后的值 &amp;gt; jvm 所能分配的数组的最大值，那么就用 Integer 的最大值&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;newCapacity &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; MAX_ARRAY_SIZE &lt;span class=&quot;token operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    newCapacity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hugeCapacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;minCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n \n  &lt;span class=&quot;token comment&quot;&gt;// 通过复制进行扩容&lt;/span&gt;\n  elementData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Arrays&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;copyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; newCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;注解应该比较详细，我们需要注意的四点是：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;扩容的规则并不是翻倍，是原来容量大小 + 容量大小的一半，直白来说，扩容后的大小是原来容量的 1.5 倍；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;ArrayList 中的数组的最大值是 Integer.MAX_VALUE，超过这个值，JVM 就不会给数组分配内存空间了。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;新增时，并没有对值进行严格的校验，所以 ArrayList 是允许 null 值的。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;从新增和扩容源码中，下面这点值得我们借鉴：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;源码在扩容的时候，有数组大小溢出意识，就是说扩容后数组的大小下界不能小于 0，上界不能大于 Integer 的最大值，这种意识我们可以学习。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;扩容完成之后，赋值是非常简单的，直接往数组上添加元素即可：elementData [size++] = e。也正是通过这种简单赋值，没有任何锁控制，所以这里的操作是线程不安全的，对于新增和扩容的实现，画了一个动图，如下：&lt;br&gt;\n&lt;img src=&quot;//img1.sycdn.imooc.com/5d5fc62e000112c203600240.gif&quot; alt=&quot;图片描述&quot;&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;扩容的本质&quot;&gt;2.3 扩容的本质&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;扩容是通过这行代码来实现的：&lt;code&gt;Arrays.copyOf(elementData, newCapacity);&lt;/code&gt;，这行代码描述的本质是数组之间的拷贝，扩容是会先新建一个符合我们预期容量的新数组，然后把老数组的数据拷贝过去，我们通过 System.arraycopy 方法进行拷贝，此方法是 native 的方法，源码如下：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/**\n * @param src     被拷贝的数组\n * @param srcPos  从数组那里开始\n * @param dest    目标数组\n * @param destPos 从目标数组那个索引位置开始拷贝\n * @param length  拷贝的长度 \n * 此方法是没有返回值的，通过 dest 的引用进行传值\n */&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;native&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;arraycopy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Object src&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; srcPos&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n                                    Object dest&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; destPos&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n                                    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;我们可以通过下面这行代码进行调用，newElementData 表示新的数组：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;System&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;arraycopy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; newElementData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;newCapacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;删除&quot;&gt;2.4 删除&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;ArrayList 删除元素有很多种方式，比如根据数组索引删除、根据值删除或批量删除等等，原理和思路都差不多，我们选取根据值删除方式来进行源码说明：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Object o&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 如果要删除的值是 null，找到第一个值是 null 的删除&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;o &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n        &lt;span class=&quot;token function&quot;&gt;fastRemove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;// 如果要删除的值不为 null，找到第一个和要删除的值相等的删除&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n      &lt;span class=&quot;token comment&quot;&gt;// 这里是根据  equals 来判断值相等的，相等后再根据索引位置进行删除&lt;/span&gt;\n      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;o&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n        &lt;span class=&quot;token function&quot;&gt;fastRemove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;我们需要注意的两点是：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;新增的时候是没有对 null 进行校验的，所以删除的时候也是允许删除 null 值的；&lt;/li&gt;\n&lt;li&gt;找到值在数组中的索引位置，是通过 equals 来判断的，如果数组元素不是基本类型，需要我们关注 equals 的具体实现。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;上面代码已经找到要删除元素的索引位置了，下面代码是根据索引位置进行元素的删除：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fastRemove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 记录数组的结构要发生变动了&lt;/span&gt;\n  modCount&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// numMoved 表示删除 index 位置的元素后，需要从 index 后移动多少个元素到前面去&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 减 1 的原因，是因为 size 从 1 开始算起，index 从 0开始算起&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; numMoved &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; size &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;numMoved &lt;span class=&quot;token operator&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;// 从 index +1 位置开始被拷贝，拷贝的起始位置是 index，长度是 numMoved&lt;/span&gt;\n    System&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;arraycopy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; elementData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; index&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; numMoved&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//数组最后一个位置赋值 null，帮助 GC&lt;/span&gt;\n  elementData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;size&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; null&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;从源码中，我们可以看出，某一个元素被删除后，为了维护数组结构，我们都会把数组后面的元素往前移动，下面动图也演示了其过程：&lt;br&gt;\n&lt;img src=&quot;//img1.sycdn.imooc.com/5d5fc643000142a403600240.gif&quot; alt=&quot;图片描述&quot;&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;迭代器&quot;&gt;2.5 迭代器&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;如果要自己实现迭代器，实现 java.util.Iterator 类就好了，ArrayList 也是这样做的，我们来看下迭代器的几个总要的参数：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; cursor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;// 迭代过程中，下一个元素的位置，默认从 0 开始。&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; lastRet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 新增场景：表示上一次迭代过程中，索引的位置；删除场景：为 -1。&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; expectedModCount &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; modCount&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;// expectedModCount 表示迭代过程中，期望的版本号；modCount 表示数组实际的版本号。&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;迭代器一般来说有三个方法：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;hasNext 还有没有值可以迭代&lt;/li&gt;\n&lt;li&gt; next 如果有值可以迭代，迭代的值是多少&lt;/li&gt;\n&lt;li&gt; remove 删除当前迭代的值&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;我们来分别看下三个方法的源码：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;&lt;strong&gt;hasNext&lt;/strong&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hasNext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; cursor &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;//cursor 表示下一个元素的位置，size 表示实际大小，如果两者相等，说明已经没有元素可以迭代了，如果不等，说明还可以迭代&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;&lt;strong&gt;next&lt;/strong&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; E &lt;span class=&quot;token function&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//迭代过程中，判断版本号有无被修改，有被修改，抛 ConcurrentModificationException 异常&lt;/span&gt;\n  &lt;span class=&quot;token function&quot;&gt;checkForComodification&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//本次迭代过程中，元素的索引位置&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; cursor&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;&amp;gt;=&lt;/span&gt; size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NoSuchElementException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  Object&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; elementData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ArrayList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;elementData&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;&amp;gt;=&lt;/span&gt; elementData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ConcurrentModificationException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 下一次迭代时，元素的位置，为下一次迭代做准备&lt;/span&gt;\n  cursor &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 返回元素值&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;E&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; elementData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;lastRet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;token comment&quot;&gt;// 版本号比较&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;checkForComodification&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;modCount &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; expectedModCount&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ConcurrentModificationException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;从源码中可以看到，next 方法就干了两件事情，第一是检验能不能继续迭代，第二是找到迭代的值，并为下一次迭代做准备（cursor+1）。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;&lt;strong&gt;remove&lt;/strong&gt;&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;// 如果上一次操作时，数组的位置已经小于 0 了，说明数组已经被删除完了&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lastRet &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;IllegalStateException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token comment&quot;&gt;//迭代过程中，判断版本号有无被修改，有被修改，抛 ConcurrentModificationException 异常&lt;/span&gt;\n  &lt;span class=&quot;token function&quot;&gt;checkForComodification&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n\n  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    ArrayList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lastRet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n    cursor &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lastRet&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;// -1 表示元素已经被删除，这里也防止重复删除&lt;/span&gt;\n    lastRet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;// 删除元素时 modCount 的值已经发生变化，在此赋值给 expectedModCount&lt;/span&gt;\n    &lt;span class=&quot;token comment&quot;&gt;// 这样下次迭代时，两者的值是一致的了&lt;/span&gt;\n    expectedModCount &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; modCount&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;IndexOutOfBoundsException&lt;/span&gt; ex&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ConcurrentModificationException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;这里我们需要注意的两点是：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;ul&gt;\n&lt;li&gt;lastRet = -1 的操作目的，是防止重复删除操作&lt;/li&gt;\n&lt;li&gt;删除元素成功，数组当前 modCount 就会发生变化，这里会把 expectedModCount 重新赋值，下次迭代时两者的值就会一致了&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;时间复杂度&quot;&gt;2.6 时间复杂度&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;从我们上面新增或删除方法的源码解析，对数组元素的操作，只需要根据数组索引，直接新增和删除，所以时间复杂度是 O (1)。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h3 id=&quot;线程安全&quot;&gt;2.7 线程安全&lt;/h3&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;我们需要强调的是，只有当 ArrayList 作为共享变量时，才会有线程安全问题，当 ArrayList 是方法内的局部变量时，是没有线程安全的问题的。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;ArrayList 有线程安全问题的本质，是因为 ArrayList 自身的 elementData、size、modConut 在进行各种操作时，都没有加锁，而且这些变量的类型并非是可见（volatile）的，所以如果多个线程对这些变量进行操作时，可能会有值被覆盖的情况。&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;类注释中推荐我们使用 Collections#synchronizedList 来保证线程安全，SynchronizedList 是通过在每个方法上面加上锁来实现，虽然实现了线程安全，但是性能大大降低，具体实现源码：&lt;/p&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;pre class=&quot;  language-java&quot;&gt;&lt;code class=&quot;prism  language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;E e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mutex&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;// synchronized 是一种轻量锁，mutex 表示一个当前 SynchronizedList&lt;/span&gt;\n        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;\n&lt;/div&gt;&lt;div class=&quot;cl-preview-section&quot;&gt;&lt;p&gt;本文从 ArrayList 整体架构出发，落地到初始化、新增、扩容、删除、迭代等核心源码实现，我们发现  ArrayList 其实就是围绕底层数组结构，各个 API 都是对数组的操作进行封装，让使用者无需感知底层实现，只需关注如何使用即可。&lt;/p&gt;\n&lt;/div&gt;";
    // 为html反转码
    article_content = article_content.replace(/\&lt\;/g, "<").replace(/\&gt\;/g, ">").replace(/\&amp\;/g, "&").replace(/\&quot\;/g, '"').replace(/\&apos\;/g, "'");
    // 递归遍历dom，处理图片懒加载
    function dfs(root) {
        var nodes = Array.prototype.slice.call(root.children);
        if (nodes.length) {
            nodes.forEach(function (node) {
                if(node.tagName == 'IMG') {
                    var src = node.src;
                    node.setAttribute('data-original', src);
                    node.setAttribute('class', 'lazyload');
                    node.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC';
                }
                dfs(node);
            });
        }
    }
    // 创建手记内容dom节点
    var articleEl = document.createElement("div");
    articleEl.innerHTML = article_content;
    // 遍历手记dom树
    dfs(articleEl);
</script>



<script type="text/javascript">

eval(function(p,a,c,k,e,d){e=function(c){return(c<a?"":e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)d[e(c)]=k[c]||e(c);k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1;};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p;}('!4(){3 b={};3 d=0;3 5=[{c:\'//k.p.h/k/m/K/L.q\',6:0},{c:\'//m.p.h/I/J-O.q\',6:0}];3 u=4(){3 j,n=e P("(^| )"+"l=([^;]*)(;|$)");9(j=r.s.M(n)){o N(j[2])}D{o C}};3 A=4(t){3 B=u();3 8=e H();8.G(8.F()+E*v*v*10);r.s="l="+t+";13="+8.14()+";15=/;T=U.h";9(t&&t!=B){R.Y.Z()}};3 x=4(i){3 7=e X();7.V=4(){W(b[i]);b[i]=C;a(i,0)};7.Q=4(){a(i,1)};b[i]=S(4(){7.z="";a(i,1)},11);7.z=5[i].c+"?t="+12.16()};3 a=4(y,6){d++;5[y].6=6;9(d==5.f){3 g=0;w(3 i=0;i<5.f;i++){9(5[i].6==1){g=1}}A(g)}};w(3 i=0;i<5.f;i++){x(i)}}()',62,69,'|||var|function|urls|flag|imgobj|exp|if|callback|timer|url|count|new|length|error|com||arr|static|IMCDNS|img|reg|return|mukewang|png|document|cookie||getcookie|60|for|checkCdn|index|src|setcookie|_0|null|else|24|getTime|setTime|Date|images|unknow|common|logo|match|unescape|80|RegExp|onerror|window|setTimeout|domain|imooc|onload|clearTimeout|Image|location|reload|1000|3000|Math|expires|toGMTString|path|random'.split('|'),0,{}))

</script>
<script src="./1_files/init.js" async=""></script>
<link rel="stylesheet" href="./1_files/saved_resource" type="text/css">
<script charset="utf-8" async="" src="./1_files/seajs-text.js"></script><script charset="utf-8" async="" src="./1_files/common.js"></script><script src="./1_files/share.js"></script><script>//remove baidu search ad
var _countAA = 0
function doBBBd(){
    var alla = document.getElementsByTagName('a')
    for(var i = 0; i < alla.length; i++){
        if(/baidu.com\/(baidu.php\?url=|adrc.php\?t)/.test(alla[i].href)){
            var _temp = alla[i].parentElement, loop = 0
            while(loop < 5){
                _temp = _temp.parentElement
                loop++
                if(_temp.parentElement.id == 'content_left'){
                    _temp.remove()
                    break
                }
            }
        }
    }
    
    if(_countAA++ < 20){
        setTimeout(doBBBd, 500)
    }
    
}
doBBBd()
document.addEventListener('keyup', function(){_countAA-=10;doBBBd()}, false)
document.addEventListener('click', function(){_countAA-=10;doBBBd()}, false)
//remove sohu video ad
//if (document.URL.indexOf("tv.sohu.com") >= 0){
//    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
//}
//remove 56.com video ad
//if (document.URL.indexOf("56.com") >= 0){
//    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
//}
</script><script charset="utf-8" async="" src="./1_files/jquery.js"></script><script charset="utf-8" async="" src="./1_files/string.js"></script><script charset="utf-8" async="" src="./1_files/userinfo.js"></script><script charset="utf-8" async="" src="./1_files/cart.js"></script><script charset="utf-8" async="" src="./1_files/cookie.js"></script><script charset="utf-8" async="" src="./1_files/suggest.js"></script><script charset="utf-8" async="" src="./1_files/store.js"></script><script charset="utf-8" async="" src="./1_files/json.js"></script><script charset="utf-8" async="" src="./1_files/im.js"></script><script charset="utf-8" async="" src="./1_files/chapter.js"></script><script charset="utf-8" async="" src="./1_files/advertiseCheck.js"></script><script charset="utf-8" async="" src="./1_files/moco.min.js"></script><script charset="utf-8" async="" src="./1_files/socket.io.min.js"></script><link rel="stylesheet" href="./1_files/share_style0_16.css"><script charset="utf-8" async="" src="./1_files/juicer.min.js"></script><script charset="utf-8" async="" src="./1_files/course_tipoff.js"></script><script charset="utf-8" async="" src="./1_files/jquery.qrcode.min.js"></script><script charset="utf-8" async="" src="./1_files/jquery.lazyload.js"></script><script charset="utf-8" async="" src="./1_files/reference.js"></script><script charset="utf-8" async="" src="./1_files/countdown.js"></script></head>

<body style="user-select: auto !important">


<!-- 窄条导航 -->

<!-- 登录入口 -->

<!-- 新人有礼入口 -->
<a class="newcomer hide index" href="http://www.imooc.com/act/newcomer" target="_blank">
    <i class="js-close-newcomer imv2-close"></i>

</a>

<div class="bindHintBox js-bindHintBox hide">
    <div class="pr">
        为了账号安全，请及时绑定邮箱和手机<a href="http://www.imooc.com/user/setbindsns" class="ml20 color-red" target="_blank">立即绑定</a>
        <button class="closeBindHint js-closeBindHint" type="button"></button>
        <div class="arrow"> </div>
    </div>
</div>


<div id="main">

<div class="sub-header clearfix fixed scrolling">
    <div class="left-back l">
        <a class="icon" href="http://www.imooc.com/read/47#catalog" title="返回上一级">
            <i class="imv2-arrow3_l"></i>
        </a>
        
            <span>慕课专栏</span>
        
    </div>
    <div class="right-title">
        <a href="javascript: void(0);" class="menu-btn js-switch-menu" title="隐藏目录">
            <i class="imv2-list_bulleted"></i>
        </a>
        <a href="http://www.imooc.com/read/47"><span>面试官系统精讲Java源码及大厂真题</span></a><em>/</em><a href="http://www.imooc.com/read/47/article/847">05 ArrayList 源码解析和设计思路   </a>
    </div>
</div>
<div class="main-con fixed scrolling">
    <!-- 左侧菜单 & 索引 -->
    <div class="left-menu" style="top: 68px;">
        <div class="catalog-con">
            <div class="inner">
                <p class="title">目录</p>
                <div class="item-box js-item-box">           <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第1章 基础</p>                 <!-- <p class="total r">共 4 小节内容</p> -->             </div>                  <ul>                                   <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/843">                                                           <div class="articleName">                         01 开篇词：为什么学习本专栏                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>1400 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>21727 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 已学完                             </div>                                                               </a>                              </li>                                       <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/844">                                                           <div class="articleName">                         02 String、Long 源码解析和面试题                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>7231 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>28849 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 已学完                             </div>                                                               </a>                              </li>                                       <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/845">                                                           <div class="articleName">                         03 Java 常用关键字理解                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>4375 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>11283 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 已学完                             </div>                                                               </a>                              </li>                                       <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/846">                                                           <div class="articleName">                         04 Arrays、Collections、Objects 常用方法源码解析                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>7516 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>10085 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 已学完                             </div>                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第2章 集合</p>                 <!-- <p class="total r">共 10 小节内容</p> -->             </div>                  <ul>                                   <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/847">                                                           <div class="articleName">                         05 ArrayList 源码解析和设计思路                        </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>8288 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>18997 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 最近阅读                             </div>                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/848">                                                           <div class="articleName">                         06 LinkedList 源码解析                        </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6788 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>14354 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/849">                                                           <div class="articleName">                         07 List 源码会问哪些面试题                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>4818 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>13333 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/850">                                                           <div class="articleName">                         08 HashMap 源码解析                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>9060 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>8570 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 已学完                             </div>                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/851">                                                           <div class="articleName">                         09 TreeMap 和 LinkedHashMap 核心源码解析                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>8912 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>4670 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/852">                                                           <div class="articleName">                         10 Map源码会问哪些面试题                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5078 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>4198 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li class="has-learned">                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/853">                                                           <div class="articleName">                         11 HashSet、TreeSet 源码解析                         </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5992 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>3133 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                      <div class="last-learn">                                 已学完                             </div>                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/854">                                                           <div class="articleName">                         12 彰显细节：看集合源码对我们实际工作的帮助和应用                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>8506 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>3000 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/855">                                                           <div class="articleName">                         13 差异对比：集合在 Java 7 和 8 有何不同和改进                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5572 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2676 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/856">                                                           <div class="articleName">                         14 简化工作：Guava Lists Maps 实际工作运用和源码                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6412 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2374 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第3章 并发集合类</p>                 <!-- <p class="total r">共 4 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/857">                                                           <div class="articleName">                         15 CopyOnWriteArrayList 源码解析和设计思路                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>7443 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>3466 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/858">                                                           <div class="articleName">                         16 ConcurrentHashMap 源码解析和设计思路                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>14024 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>4402 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/859">                                                           <div class="articleName">                         17 并发 List、Map源码面试题                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>3872 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2485 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/860">                                                           <div class="articleName">                         18 场景集合：并发 List、Map的应用场景                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5521 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1911 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第4章 队列</p>                 <!-- <p class="total r">共 8 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/861">                                                           <div class="articleName">                         19 LinkedBlockingQueue 源码解析                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>8115 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>5287 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/862">                                                           <div class="articleName">                         20 SynchronousQueue 源码解析                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>12248 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2130 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/863">                                                           <div class="articleName">                         21 DelayQueue 源码解析                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>7484 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1679 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/864">                                                           <div class="articleName">                         22 ArrayBlockingQueue 源码解析                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6185 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1557 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/865">                                                           <div class="articleName">                         23 队列在源码方面的面试题                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5115 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1638 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/866">                                                           <div class="articleName">                         24 举一反三：队列在 Java 其它源码中的应用                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5133 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1639 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/867">                                                           <div class="articleName">                         25 整体设计：队列设计思想、工作中使用场景                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>3231 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1329 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/868">                                                           <div class="articleName">                         26 惊叹面试官：由浅入深手写队列                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6168 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1615 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第5章 线程</p>                 <!-- <p class="total r">共 3 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/869">                                                           <div class="articleName">                         27 Thread 源码解析                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>7829 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>4475 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/870">                                                           <div class="articleName">                         28 Future、ExecutorService 源码解析                        </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>10542 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2168 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/871">                                                           <div class="articleName">                         29 押宝线程源码面试题                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6373 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1918 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第6章 锁</p>                 <!-- <p class="total r">共 7 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/872">                                                           <div class="articleName">                         30 AbstractQueuedSynchronizer 源码解析（上）                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>15475 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2716 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/873">                                                           <div class="articleName">                         31 AbstractQueuedSynchronizer 源码解析（下）                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>9106 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1543 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/874">                                                           <div class="articleName">                         32 ReentrantLock 源码解析                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>7062 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1574 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/875">                                                           <div class="articleName">                         33 CountDownLatch、Atomic 等其它源码解析                          </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6983 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1261 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/876">                                                           <div class="articleName">                         34 只求问倒：连环相扣系列锁面试题                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>4512 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1358 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/877">                                                           <div class="articleName">                         35 经验总结：各种锁在工作中使用场景和细节                         </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6183 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1182 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/878">                                                           <div class="articleName">                         36 从容不迫：重写锁的设计结构和细节                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5459 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1085 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第7章 线程池</p>                 <!-- <p class="total r">共 4 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/879">                                                           <div class="articleName">                         37 ThreadPoolExecutor 源码解析                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>19372 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2125 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/880">                                                           <div class="articleName">                         38 线程池源码面试题                         </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5064 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1408 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/881">                                                           <div class="articleName">                         39 经验总结：不同场景，如何使用线程池                          </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>4530 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1224 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/882">                                                           <div class="articleName">                         40 打动面试官：线程池流程编排中的运用实战                        </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>5952 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1169 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第8章 Lambda 流</p>                 <!-- <p class="total r">共 2 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/883">                                                           <div class="articleName">                         41 突破难点：如何看 Lambda 源码                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>4318 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1545 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/884">                                                           <div class="articleName">                         42 常用的 Lambda 表达式使用场景解析和应用                         </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>10632 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1262 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第9章 其他</p>                 <!-- <p class="total r">共 5 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/885">                                                           <div class="articleName">                         43 ThreadLocal 源码解析                        </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>8243 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1687 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/886">                                                           <div class="articleName">                         44 场景实战：ThreadLocal 在上下文传值场景下的实践                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>3834 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1197 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/887">                                                           <div class="articleName">                         45 Socket 源码及面试题                       </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>6648 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1273 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/888">                                                           <div class="articleName">                         46 ServerSocket 源码及面试题                        </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>2864 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>970 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                                       <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/889">                                                           <div class="articleName">                         47 工作实战：Socket 结合线程池的使用                      </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>9874 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>1078 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>          <div class="item">                      <!-- 有章模式 -->             <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->             <div class="section clearfix">                 <p class="sec_name l">第10章 专栏总结</p>                 <!-- <p class="total r">共 1 小节内容</p> -->             </div>                  <ul>                                   <li>                                                                        <!-- 开放 -->                         <a href="http://www.imooc.com/read/47/article/890">                                                           <div class="articleName">                         48 一起看过的 Java 源码和面试真题                     </div>                     <div class="info">                                                  <!-- 开放 -->                             <!-- <span>1354 个文字</span>                              <i class="imv2-dot_samll"></i>                             <span>2449 次阅读</span>-->                                                                                                        </div>                                               <!-- 已经购买 -->                                                               </a>                              </li>                      </ul>     </div>       <p class="bottom-line">已到底部</p></div>
            </div>
        </div>
    </div>
    <div class="right-content">
        <div class="container clearfix" id="top" style="display: block;">
            
            <div class="reference-con">
                <div class="inner">
                    <div class="top-head">
                        索引目录
                        <i class="imv2-arrow2_d r"></i>
                        <i class="imv2-arrow2_u r"></i>
                    </div>
                    <div class="tree-con" style=""><ul><li class="level_1"><a href="http://www.imooc.com/read/47/article/847#anchor_0">引导语</a></li><li class="level_1 active"><a href="http://www.imooc.com/read/47/article/847#anchor_1">1 整体架构</a></li><li class="level_1"><a href="http://www.imooc.com/read/47/article/847#anchor_2">2 源码解析</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_3">2.1 初始化</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_4">2.2 新增和扩容实现</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_5">2.3 扩容的本质</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_6">2.4 删除</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_7">2.5 迭代器</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_8">2.6 时间复杂度</a></li><li class="level_2"><a href="http://www.imooc.com/read/47/article/847#anchor_9">2.7 线程安全</a></li><li class="level_1"><a href="http://www.imooc.com/read/47/article/847#anchor_10">总结</a></li></ul></div>
                </div>
            </div>
            <div class="center_con js-center_con l">
                <div class="article-con">
                                            <!-- 买过的阅读 -->
                        

                    
                    <div class="art-title">
                        05 ArrayList 源码解析和设计思路   
                    </div>
                    <div class="art-info clearfix">
                        
                        <span class="l">
                            更新时间：2019-11-26 09:44:51
                        </span>
                    </div>
                    <div class="art-top">
                                                <img src="./1_files/5d6355860001b65c06400359.jpg" alt="">
                                                                        <div class="famous-word-box">
                            <img src="./1_files/bg-l.png" alt="" class="bg1 bg">
                            <img src="./1_files/bg-r.png" alt="" class="bg2 bg">
                            <div class="famous-word">耐心和恒心总会得到报酬的。<p class="author">——爱因斯坦</p></div>
                        </div>
                                            </div>
                    <div class="art-content js-lookimg">
                        <div><div class="cl-preview-section"><a id="anchor_0_virtual" class="virtual_anchor"></a><h2 id="引导语">引导语</h2>
</div><div class="cl-preview-section"><p>ArrayList 我们几乎每天都会使用到，但真正面试的时候，发现还是有不少人对源码细节说不清楚，给面试官留下比较差的印象，本小节就和大家一起看看面试中和 ArrayList 相关的源码。</p>
</div><div class="cl-preview-section"><a id="anchor_1_virtual" class="virtual_anchor"></a><h2 id="整体架构">1 整体架构</h2>
</div><div class="cl-preview-section"><p>ArrayList 整体架构比较简单，就是一个数组结构，比较简单，如下图：<br>
<img src="./1_files/5d5fc5f80001e20e15080238.png" alt="图片描述" data-original="http://img1.sycdn.imooc.com/5d5fc5f80001e20e15080238.png" class="" style="cursor: pointer; display: block;">图中展示是长度为 10 的数组，从 1 开始计数，index 表示数组的下标，从 0 开始计数，elementData 表示数组本身，源码中除了这两个概念，还有以下三个基本概念：</p>
</div><div class="cl-preview-section"><ul>
<li>DEFAULT_CAPACITY 表示数组的初始大小，默认是 10，这个数字要记住；</li>
<li>size 表示当前数组的大小，类型 int，没有使用 volatile 修饰，非线程安全的；</li>
<li>modCount 统计当前数组被修改的版本次数，数组结构有变动，就会 +1。</li>
</ul>
</div><div class="cl-preview-section"><p><strong>类注释</strong></p>
</div><div class="cl-preview-section"><p>看源码，首先要看类注释，我们看看类注释上面都说了什么，如下：</p>
</div><div class="cl-preview-section"><ul>
<li>允许 put null 值，会自动扩容；</li>
<li>size、isEmpty、get、set、add 等方法时间复杂度都是 O (1)；</li>
<li>是非线程安全的，多线程情况下，推荐使用线程安全类：Collections#synchronizedList；</li>
<li>增强 for 循环，或者使用迭代器迭代过程中，如果数组大小被改变，会快速失败，抛出异常。</li>
</ul>
</div><div class="cl-preview-section"><p>除了上述注释中提到的 4 点，初始化、扩容的本质、迭代器等问题也经常被问，接下来我们从源码出发，一一解析。</p>
</div><div class="cl-preview-section"><a id="anchor_2_virtual" class="virtual_anchor"></a><h2 id="源码解析">2 源码解析</h2>
</div><div class="cl-preview-section"><a id="anchor_3_virtual" class="virtual_anchor"></a><h3 id="初始化">2.1 初始化</h3>
</div><div class="cl-preview-section"><p>我们有三种初始化办法：无参数直接初始化、指定大小初始化、指定初始数据初始化，源码如下：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//无参数直接初始化，数组大小为空</span>
<span class="token keyword">public</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//指定初始数据初始化</span>
<span class="token keyword">public</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span>Collection<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token operator">&gt;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//elementData 是保存数组的容器，默认为 null</span>
    elementData <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//如果给定的集合（c）数据有值</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span>
        <span class="token comment">//如果集合元素类型不是 Object 类型，我们会转成 Object</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elementData <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 给定集合（c）无值，则默认空数组</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><span id="code-preview" style="display: none;">预览</span></pre>
</div><div class="cl-preview-section"><p>除了源码的中文注释，我们补充两点：</p>
</div><div class="cl-preview-section"><p>1：ArrayList 无参构造器初始化时，默认大小是空数组，并不是大家常说的 10，10 是在第一次 add 的时候扩容的数组值。</p>
</div><div class="cl-preview-section"><p>2：指定初始数据初始化时，我们发现一个这样子的注释 see 6260652，这是 Java 的一个 bug，意思是当给定集合内的元素不是 Object 类型时，我们会转化成 Object 的类型。一般情况下都不会触发此 bug，只有在下列场景下才会触发：ArrayList 初始化之后（ArrayList 元素非 Object 类型），再次调用 toArray 方法，得到 Object 数组，并且往 Object 数组赋值时，才会触发此 bug，代码和原因如图：<br>
<img src="./1_files/5d5fc6100001109518100714.png" alt="图片描述" data-original="http://img1.sycdn.imooc.com/5d5fc6100001109518100714.png" class="" style="cursor: pointer; display: block;">官方查看文档地址：<a href="https://bugs.java.com/bugdatabase/view_bug.do?bug_id=6260652%EF%BC%8C%E9%97%AE%E9%A2%98%E5%9C%A8">https://bugs.java.com/bugdatabase/view_bug.do?bug_id=6260652，问题在</a> Java 9 中被解决。</p>
</div><div class="cl-preview-section"><a id="anchor_4_virtual" class="virtual_anchor"></a><h3 id="新增和扩容实现">2.2 新增和扩容实现</h3>
</div><div class="cl-preview-section"><p>新增就是往数组中添加元素，主要分成两步：</p>
</div><div class="cl-preview-section"><ul>
<li>判断是否需要扩容，如果需要执行扩容操作；</li>
<li>直接赋值。</li>
</ul>
</div><div class="cl-preview-section"><p>两步源码体现如下：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//确保数组大小是否足够，不够执行扩容，size 为当前数组的大小</span>
  <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount!!</span>
  <span class="token comment">//直接赋值，线程不安全的</span>
  elementData<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>我们先看下扩容（ensureCapacityInternal）的源码：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//如果初始化数组大小时，有给定初始值，以给定的大小为准，不走 if 逻辑</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData <span class="token operator">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    minCapacity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>DEFAULT_CAPACITY<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//确保容积足够</span>
  <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//记录数组被修改</span>
  modCount<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token comment">// 如果我们期望的最小容量大于目前数组的长度，那么就扩容</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">-</span> elementData<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">grow</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//扩容，并把现有数据拷贝到新的数组里面去</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token comment">// oldCapacity &gt;&gt; 1 是把 oldCapacity 除以 2 的意思</span>
  <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果扩容后的值 &lt; 我们的期望值，扩容后的值就等于我们的期望值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>

  <span class="token comment">// 如果扩容后的值 &gt; jvm 所能分配的数组的最大值，那么就用 Integer 的最大值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> MAX_ARRAY_SIZE <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    newCapacity <span class="token operator">=</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token comment">// 通过复制进行扩容</span>
  elementData <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p>注解应该比较详细，我们需要注意的四点是：</p>
</div><div class="cl-preview-section"><ul>
<li>
<p>扩容的规则并不是翻倍，是原来容量大小 + 容量大小的一半，直白来说，扩容后的大小是原来容量的 1.5 倍；</p>
</li>
<li>
<p>ArrayList 中的数组的最大值是 Integer.MAX_VALUE，超过这个值，JVM 就不会给数组分配内存空间了。</p>
</li>
<li>
<p>新增时，并没有对值进行严格的校验，所以 ArrayList 是允许 null 值的。</p>
</li>
</ul>
</div><div class="cl-preview-section"><p>从新增和扩容源码中，下面这点值得我们借鉴：</p>
</div><div class="cl-preview-section"><ul>
<li>源码在扩容的时候，有数组大小溢出意识，就是说扩容后数组的大小下界不能小于 0，上界不能大于 Integer 的最大值，这种意识我们可以学习。</li>
</ul>
</div><div class="cl-preview-section"><p>扩容完成之后，赋值是非常简单的，直接往数组上添加元素即可：elementData [size++] = e。也正是通过这种简单赋值，没有任何锁控制，所以这里的操作是线程不安全的，对于新增和扩容的实现，画了一个动图，如下：<br>
<img src="./1_files/5d5fc62e000112c203600240.gif" alt="图片描述" data-original="http://img1.sycdn.imooc.com/5d5fc62e000112c203600240.gif" class="" style="cursor: pointer; display: block;"></p>
</div><div class="cl-preview-section"><a id="anchor_5_virtual" class="virtual_anchor"></a><h3 id="扩容的本质">2.3 扩容的本质</h3>
</div><div class="cl-preview-section"><p>扩容是通过这行代码来实现的：<code>Arrays.copyOf(elementData, newCapacity);</code>，这行代码描述的本质是数组之间的拷贝，扩容是会先新建一个符合我们预期容量的新数组，然后把老数组的数据拷贝过去，我们通过 System.arraycopy 方法进行拷贝，此方法是 native 的方法，源码如下：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token comment">/**
 * @param src     被拷贝的数组
 * @param srcPos  从数组那里开始
 * @param dest    目标数组
 * @param destPos 从目标数组那个索引位置开始拷贝
 * @param length  拷贝的长度 
 * 此方法是没有返回值的，通过 dest 的引用进行传值
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">arraycopy</span><span class="token punctuation">(</span>Object src<span class="token punctuation">,</span> <span class="token keyword">int</span> srcPos<span class="token punctuation">,</span>
                                    Object dest<span class="token punctuation">,</span> <span class="token keyword">int</span> destPos<span class="token punctuation">,</span>
                                    <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div><div class="cl-preview-section"><p>我们可以通过下面这行代码进行调用，newElementData 表示新的数组：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java">System<span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> newElementData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>elementData<span class="token punctuation">.</span>length<span class="token punctuation">,</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="cl-preview-section"><a id="anchor_6_virtual" class="virtual_anchor"></a><h3 id="删除">2.4 删除</h3>
</div><div class="cl-preview-section"><p>ArrayList 删除元素有很多种方式，比如根据数组索引删除、根据值删除或批量删除等等，原理和思路都差不多，我们选取根据值删除方式来进行源码说明：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果要删除的值是 null，找到第一个值是 null 的删除</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fastRemove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果要删除的值不为 null，找到第一个和要删除的值相等的删除</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token comment">// 这里是根据  equals 来判断值相等的，相等后再根据索引位置进行删除</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fastRemove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><span id="code-preview" style="display: none;">预览</span></pre>
</div><div class="cl-preview-section"><p>我们需要注意的两点是：</p>
</div><div class="cl-preview-section"><ul>
<li>新增的时候是没有对 null 进行校验的，所以删除的时候也是允许删除 null 值的；</li>
<li>找到值在数组中的索引位置，是通过 equals 来判断的，如果数组元素不是基本类型，需要我们关注 equals 的具体实现。</li>
</ul>
</div><div class="cl-preview-section"><p>上面代码已经找到要删除元素的索引位置了，下面代码是根据索引位置进行元素的删除：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">fastRemove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 记录数组的结构要发生变动了</span>
  modCount<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token comment">// numMoved 表示删除 index 位置的元素后，需要从 index 后移动多少个元素到前面去</span>
  <span class="token comment">// 减 1 的原因，是因为 size 从 1 开始算起，index 从 0开始算起</span>
  <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">// 从 index +1 位置开始被拷贝，拷贝的起始位置是 index，长度是 numMoved</span>
    System<span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//数组最后一个位置赋值 null，帮助 GC</span>
  elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> null<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><span id="code-preview" style="display: none;">预览</span></pre>
</div><div class="cl-preview-section"><p>从源码中，我们可以看出，某一个元素被删除后，为了维护数组结构，我们都会把数组后面的元素往前移动，下面动图也演示了其过程：<br>
<img src="./1_files/5d5fc643000142a403600240.gif" alt="图片描述" data-original="http://img1.sycdn.imooc.com/5d5fc643000142a403600240.gif" class="" style="cursor: pointer; display: block;"></p>
</div><div class="cl-preview-section"><a id="anchor_7_virtual" class="virtual_anchor"></a><h3 id="迭代器">2.5 迭代器</h3>
</div><div class="cl-preview-section"><p>如果要自己实现迭代器，实现 java.util.Iterator 类就好了，ArrayList 也是这样做的，我们来看下迭代器的几个总要的参数：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">int</span> cursor<span class="token punctuation">;</span><span class="token comment">// 迭代过程中，下一个元素的位置，默认从 0 开始。</span>
<span class="token keyword">int</span> lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 新增场景：表示上一次迭代过程中，索引的位置；删除场景：为 -1。</span>
<span class="token keyword">int</span> expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span><span class="token comment">// expectedModCount 表示迭代过程中，期望的版本号；modCount 表示数组实际的版本号。</span>
</code></pre>
</div><div class="cl-preview-section"><p>迭代器一般来说有三个方法：</p>
</div><div class="cl-preview-section"><ul>
<li>hasNext 还有没有值可以迭代</li>
<li> next 如果有值可以迭代，迭代的值是多少</li>
<li> remove 删除当前迭代的值</li>
</ul>
</div><div class="cl-preview-section"><p>我们来分别看下三个方法的源码：</p>
</div><div class="cl-preview-section"><p><strong>hasNext</strong></p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> cursor <span class="token operator">!=</span> size<span class="token punctuation">;</span><span class="token comment">//cursor 表示下一个元素的位置，size 表示实际大小，如果两者相等，说明已经没有元素可以迭代了，如果不等，说明还可以迭代</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="cl-preview-section"><p><strong>next</strong></p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">public</span> E <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//迭代过程中，判断版本号有无被修改，有被修改，抛 ConcurrentModificationException 异常</span>
  <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//本次迭代过程中，元素的索引位置</span>
  <span class="token keyword">int</span> i <span class="token operator">=</span> cursor<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> size<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchElementException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">[</span><span class="token punctuation">]</span> elementData <span class="token operator">=</span> ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 下一次迭代时，元素的位置，为下一次迭代做准备</span>
  cursor <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token comment">// 返回元素值</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>E<span class="token punctuation">)</span> elementData<span class="token punctuation">[</span>lastRet <span class="token operator">=</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 版本号比较</span>
<span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>modCount <span class="token operator">!=</span> expectedModCount<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><span id="code-preview" style="display: none;">预览</span></pre>
</div><div class="cl-preview-section"><p>从源码中可以看到，next 方法就干了两件事情，第一是检验能不能继续迭代，第二是找到迭代的值，并为下一次迭代做准备（cursor+1）。</p>
</div><div class="cl-preview-section"><p><strong>remove</strong></p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果上一次操作时，数组的位置已经小于 0 了，说明数组已经被删除完了</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lastRet <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//迭代过程中，判断版本号有无被修改，有被修改，抛 ConcurrentModificationException 异常</span>
  <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>lastRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cursor <span class="token operator">=</span> lastRet<span class="token punctuation">;</span>
    <span class="token comment">// -1 表示元素已经被删除，这里也防止重复删除</span>
    lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// 删除元素时 modCount 的值已经发生变化，在此赋值给 expectedModCount</span>
    <span class="token comment">// 这样下次迭代时，两者的值是一致的了</span>
    expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IndexOutOfBoundsException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><span id="code-preview" style="display: none;">预览</span></pre>
</div><div class="cl-preview-section"><p>这里我们需要注意的两点是：</p>
</div><div class="cl-preview-section"><ul>
<li>lastRet = -1 的操作目的，是防止重复删除操作</li>
<li>删除元素成功，数组当前 modCount 就会发生变化，这里会把 expectedModCount 重新赋值，下次迭代时两者的值就会一致了</li>
</ul>
</div><div class="cl-preview-section"><a id="anchor_8_virtual" class="virtual_anchor"></a><h3 id="时间复杂度">2.6 时间复杂度</h3>
</div><div class="cl-preview-section"><p>从我们上面新增或删除方法的源码解析，对数组元素的操作，只需要根据数组索引，直接新增和删除，所以时间复杂度是 O (1)。</p>
</div><div class="cl-preview-section"><a id="anchor_9_virtual" class="virtual_anchor"></a><h3 id="线程安全">2.7 线程安全</h3>
</div><div class="cl-preview-section"><p>我们需要强调的是，只有当 ArrayList 作为共享变量时，才会有线程安全问题，当 ArrayList 是方法内的局部变量时，是没有线程安全的问题的。</p>
</div><div class="cl-preview-section"><p>ArrayList 有线程安全问题的本质，是因为 ArrayList 自身的 elementData、size、modConut 在进行各种操作时，都没有加锁，而且这些变量的类型并非是可见（volatile）的，所以如果多个线程对这些变量进行操作时，可能会有值被覆盖的情况。</p>
</div><div class="cl-preview-section"><p>类注释中推荐我们使用 Collections#synchronizedList 来保证线程安全，SynchronizedList 是通过在每个方法上面加上锁来实现，虽然实现了线程安全，但是性能大大降低，具体实现源码：</p>
</div><div class="cl-preview-section"><pre class="  language-java"><code class="prism  language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mutex<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// synchronized 是一种轻量锁，mutex 表示一个当前 SynchronizedList</span>
        <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><span id="code-preview" style="display: none;">预览</span></pre>
</div><div class="cl-preview-section"><a id="anchor_10_virtual" class="virtual_anchor"></a><h2 id="总结">总结</h2>
</div><div class="cl-preview-section"><p>本文从 ArrayList 整体架构出发，落地到初始化、新增、扩容、删除、迭代等核心源码实现，我们发现  ArrayList 其实就是围绕底层数组结构，各个 API 都是对数组的操作进行封装，让使用者无需感知底层实现，只需关注如何使用即可。</p>
</div></div>
                    </div>
                                            <!-- 买过的阅读 -->
                        <div class="art-next-prev clearfix">
                                                                                                <!-- 已买且开放 或者可以试读 -->
                                    <a href="http://www.imooc.com/read/47/article/846">
                                                                    <div class="prev l clearfix">
                                        <div class="icon l">
                                            <i class="imv2-arrow3_l"></i>
                                        </div>
                                        <p>
                                            04 Arrays、Collections、Objects 常用方法源码解析 
                                        </p>
                                    </div>
                                </a>
                                                                                                                            <!-- 已买且开放 或者可以试读 -->
                                    <a href="http://www.imooc.com/read/47/article/848">
                                                                    <div class="next r clearfix">
                                        <p>
                                            06 LinkedList 源码解析   
                                        </p>
                                        <div class="icon r">
                                            <i class="imv2-arrow3_r"></i>
                                        </div>

                                    </div>
                                </a>
                                                    </div>
                                    </div>
                <div class="comments-con js-comments-con" id="coments_con">     <div class="number">精选留言 <span class="js-number">40</span></div>     <div class="comments">         <div class="input-fake js-showcommentModal">             欢迎在这里发表留言，作者筛选后可公开显示         </div>                      <ul class="comments-list js-comments-list">                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/8030152/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/5b8ce90a000165b102000199-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/8030152/articles" target="_blank">                                         <div class="name l">qq_慕仙643114</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     如果我们不指定位置直接添加元素时(add(E element))，元素会默认会添加在最后，不会触发底层数组的复制，不考虑底层数组自动扩容的话，时间复杂度为O(1) ，在指定位置添加元素(add(int index, E element))，需要复制底层数组，根据最坏打算，时间复杂度是O(n)。                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="4333">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>5</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="4333">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="4333" data-uid="8030152" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-03-03</div>                                 </div>                             </div>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/2065093/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/55817d3200015f9d01000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/2065093/articles" target="_blank">                                         <div class="name l">qq_继续_1</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     remove 元素后，为何要将 numMoved 的元素向前移动再将 --size 的元素赋值为 null，而不是直接将被删除元素索引位置赋值为 null 呢？是为了让数组看起来更连续吗？
[1,2,3,4,5,6]  -&gt;  [1,2,3,5,6,null] 为何不是 [1,2,3,null,5,6]。                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="4245">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="4245">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="4245" data-uid="2065093" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-02-27</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8030152/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5b8ce90a000165b102000199-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8030152/articles" target="_blank">                                                         <div class="name l">qq_慕仙643114</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2065093/articles" target="_blank">                                                                 <div class="name l">qq_继续_1</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     不是看起来连续，而是本来就要连续，不然你删了第四个，再取第四个就会取到 null， 而按道理应该是拿到下一个，也就是 5                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3640" data-name="qq_慕仙643114">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3640" data-uid="8030152" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-03 18:31:46</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/180334/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5df3b8e20001935002000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/180334/articles" target="_blank">                                                         <div class="name l">贾亦真亦贾</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2065093/articles" target="_blank">                                                                 <div class="name l">qq_继续_1</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     你这都不连续了，怎么取值                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3872" data-name="贾亦真亦贾">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3872" data-uid="180334" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">1天前</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/6639168/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/533e4cc800016ffd02200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6639168/articles" target="_blank">                                         <div class="name l">DIDI_</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师您好，请问remove()方法的使用情境是什么样的啊，已经有了删除指定元素，和删除指定位置的元素，这个无参数的remove()方法什么时候使用呢？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3999">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3999">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3999" data-uid="6639168" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-02-13</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7673091/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/54586849000122fd02200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7673091/articles" target="_blank">                                                         <div class="name l">工程詩</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6639168/articles" target="_blank">                                                                 <div class="name l">DIDI_</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     你看下这个方法是怎么用的就知道啦                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3831" data-name="工程詩">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3831" data-uid="7673091" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">5天前</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/5435102/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/593e1ab100013d4101000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/5435102/articles" target="_blank">                                         <div class="name l">qq_左撇子A_0</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     if (i &gt;= size) throw new NoSuchElementException();
Object[] elementData = ArrayList.this.elementData;
if (i &gt;= elementData.length) throw new ConcurrentModificationException();
在ArrayList迭代器的next方法中第一个if判断 i如果不大于 size说明是合法的 i，那么第二个if不就没有必要判断是否大于数组长度了吗，如果 i小于size肯定也小于 elementData.length啊（siz不是永远小于elementData.length的吗）。如果 i大于等于 size，第一个if直接就抛出异常了，第二个 if貌似永远不会被执行                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3989">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3989">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3989" data-uid="5435102" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-02-13</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5e4373ce000176c211101110-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                         <div class="name l">java吴彦祖</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/5435102/articles" target="_blank">                                                                 <div class="name l">qq_左撇子A_0</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     elementData.length的长度是有可能大于size的,在remove方法当中,最后一步elementData[--size] = null;将size-1,但是elementData.length在此时还没有-1,只是将最后一位置null.
还有一个方法public void trimToSize() {
        modCount++;
        if (size &amp;lt; elementData.length) {
            elementData = (size == 0)
              ? EMPTY_ELEMENTDATA
              : Arrays.copyOf(elementData, size);
        }
    }可以去看看源码                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3778" data-name="java吴彦祖">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3778" data-uid="8528649" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-12 21:13:09</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5e4373ce000176c211101110-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                         <div class="name l">java吴彦祖</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/5435102/articles" target="_blank">                                                                 <div class="name l">qq_左撇子A_0</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     看错你的意思了...抱歉,好像确实这第二个if没有存在的意义                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3779" data-name="java吴彦祖">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3779" data-uid="8528649" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-12 21:33:30</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5e4373ce000176c211101110-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                         <div class="name l">java吴彦祖</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/5435102/articles" target="_blank">                                                                 <div class="name l">qq_左撇子A_0</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     应该判断的情况是多线程情况下的,在计算完size以后,如果有别的线程删除了元素的话,那么length是会变小,而这种情况下size就可能大于length,所以后面再判断一次.只是猜想,不知道是不是这样                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3780" data-name="java吴彦祖">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3780" data-uid="8528649" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-12 21:57:25</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/5300046/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/593f5cda000116c211101110-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/5300046/articles" target="_blank">                                         <div class="name l">移动的红烧肉</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     Arrays.asList 本身是 Arrays 内部实现，这个 BUG 我感觉太难出现了                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3964">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3964">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3964" data-uid="5300046" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-02-12</div>                                 </div>                             </div>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/8486112/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/images/unknow-160.png)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/8486112/articles" target="_blank">                                         <div class="name l">馬強Korn</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     MAX_ARRAY_SIZE 不是Integer.MAX_VALUE。而是MAX_ARRAY_SIZE = Integer.MAX_VALUE -   8；                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3923">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3923">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3923" data-uid="8486112" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-02-10</div>                                 </div>                             </div>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/1252430/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/5e1aefe00001470306980697-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/1252430/articles" target="_blank">                                         <div class="name l">栗喵</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     ArrayList中add方法的时间复杂度不是O(1)吧？ 源码中的解释是这样的呀：“The add operation runs in amortized constant time, that is, adding n elements requires O(n) time. ”                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3873">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3873">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3873" data-uid="1252430" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-02-06</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/3496723/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/54584db9000199ca02200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/3496723/articles" target="_blank">                                                         <div class="name l">Max_Cooper</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/1252430/articles" target="_blank">                                                                 <div class="name l">栗喵</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     作者此处应该是特指在ArrayList尾部加入1个元素。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3275" data-name="Max_Cooper">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3275" data-uid="3496723" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-02-08 21:06:15</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/7109637/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/53339fdf00019de902200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7109637/articles" target="_blank">                                         <div class="name l">youcai35</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     ArrayList testBatchInsert 调换单个循环和批量循环时间顺序显示结果刚好相反，单独放入到两个方法执行，显示结果差距不是很大，希望老师能够抽时间答疑解惑                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3521">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3521">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3521" data-uid="7109637" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2020-01-06</div>                                 </div>                             </div>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/7945317/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/5b8cdb7e0001b93c02000197-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7945317/articles" target="_blank">                                         <div class="name l">慕运维8132720</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     arraylist 在初始化的时候，有两个构造函数。一个无参，一个有参。

我有个问题，无参的时候给了一个空数组；有参情况下，参数为 0 的时候，也是给空数组。 但是代码里面设置的两个空数组，为何不用同一个呢？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3298">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3298">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3298" data-uid="7945317" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-12-17</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/195732/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/53a0e5420001c09201800180-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/195732/articles" target="_blank">                                                         <div class="name l">JueYingCoder</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7945317/articles" target="_blank">                                                                 <div class="name l">慕运维8132720</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     为什么有两个空数组，看源码注释

/**
     * Shared empty array instance used for default sized empty instances. We
     * distinguish this from EMPTY_ELEMENTDATA to know how much to inflate when
     * first element is added.
     */
    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3032" data-name="JueYingCoder">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3032" data-uid="195732" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-01-07 18:23:15</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/5e4373ce000176c211101110-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8528649/articles" target="_blank">                                                         <div class="name l">java吴彦祖</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7945317/articles" target="_blank">                                                                 <div class="name l">慕运维8132720</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     用来区分第一次add元素时怎样给数组扩容                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3777" data-name="java吴彦祖">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3777" data-uid="8528649" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-12 20:59:43</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/6366873/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/533e4d710001852702000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6366873/articles" target="_blank">                                         <div class="name l">萌萌萌唬</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;这个 -8 是为什么？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3159">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3159">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3159" data-uid="6366873" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-12-07</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7463250/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/54585050000156a302200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7463250/articles" target="_blank">                                                         <div class="name l">慕莱坞5107480</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6366873/articles" target="_blank">                                                                 <div class="name l">萌萌萌唬</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     一些vm在数组中保留一些头字。尝试分配较大的数组可能会导致OutOfMemory错误：请求的数组大小超过了虚拟机限制                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3436" data-name="慕莱坞5107480">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3436" data-uid="7463250" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-02-18 20:30:46</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                        <li class="comment clearfix">                                          <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/545864190001966102200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                         <div class="name l">所相虚妄</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     synchronized 是一种轻量锁 。。。
synchronized 不是重量锁么。。。                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3153">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3153">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3153" data-uid="7839242" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-12-07</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/6969428/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/533e52b90001456f02000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/6969428/articles" target="_blank">                                                         <div class="name l">qq_铂协成员_0</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                                                 <div class="name l">所相虚妄</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     jdk 1.6 优化了，之前是重量锁                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2956" data-name="qq_铂协成员_0">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2956" data-uid="6969428" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-12-25 21:18:17</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/6432073/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5d10f7b9000192d809600960-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/6432073/articles" target="_blank">                                                         <div class="name l">上山嬲老虎</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6969428/articles" target="_blank">                                                                 <div class="name l">qq_铂协成员_0</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     明明是偏向锁＋轻量锁＋重量锁                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3556" data-name="上山嬲老虎">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3556" data-uid="6432073" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-02-27 03:08:56</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7748988/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/545847aa0001063202200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7748988/articles" target="_blank">                                                         <div class="name l">哈尔滨霍建华</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                                                 <div class="name l">所相虚妄</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     明明是，无锁，偏向锁，轻量锁，重量锁&lt;br /&gt;                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3790" data-name="哈尔滨霍建华">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3790" data-uid="7748988" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-13 00:42:27</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/545845e900013e3e02200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                         <div class="name l">凉凉那个凉凉</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     迭代器的意义是什么？迭代器中的功能用for循环也完全都能简单实现吧                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="3130">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="3130">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="3130" data-uid="3162691" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-12-05</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/545864190001966102200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                                         <div class="name l">所相虚妄</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                                                 <div class="name l">凉凉那个凉凉</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     foreach增强就是靠着迭代器实现的。
迭代器里还有安全的remove方法。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2786" data-name="所相虚妄">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2786" data-uid="7839242" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-12-07 01:37:12</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/6366873/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/533e4d710001852702000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/6366873/articles" target="_blank">                                                         <div class="name l">萌萌萌唬</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                                                 <div class="name l">凉凉那个凉凉</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     迭代器是一种同一的集合调用机制，调用方式都一样的，就如同接口一样，有一个统一的如口                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2788" data-name="萌萌萌唬">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2788" data-uid="6366873" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-12-07 15:58:32</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                                                 <div class="name l">凉凉那个凉凉</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     下面几个同学回答的都非常好，我理解这可能就是一种抽象的思想，比如我们想要 List 循环时，我们给 List 写 for 循环，想要 Set 循环时，我们给 Set 写 for 循环，如果再来 Map 呢？这时候我们会发现这些循环基本都是重复代码，而且还有一些坑在里面，这时候我们就可以把循环这种行为抽象成迭代器，这样也方便容器的扩展，比如以后新建一个容器后，只要容器实现了迭代器的规范，自然就拥有的了迭代的功能，这就是我们平时工作中经常要到的方法论：先复制粘贴，然后再把公用的抽象，最后经过验证后，把抽象的接口提供给其他程序使用。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2800" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2800" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-12-08 13:41:07</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/2930191/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/57f360b3000149f601000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/2930191/articles" target="_blank">                                         <div class="name l">洗衣粉1</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，elementData设置成了transient，那ArrayList是怎么把元素序列化的呢？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2634">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2634">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2634" data-uid="2930191" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-11-02</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2930191/articles" target="_blank">                                                                 <div class="name l">洗衣粉1</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     同学你好，这个问题其实自己 debug 一下基本就能发现问题，多多 debug。
和序列化工具关系很大，我用的是阿里的 fastjson 进行序列化，debug 在 com.alibaba.fastjson.serializer.ListSerializer 68行左右，会把 List 里面每个值拿出来 append 到 SerializeWriter(可以理解成 StringBuffer的缓冲区) 上，最后输出一定格式的字符串，如果是其他序列化工具的话，可能又是其他的方式了，transient 关键字用途是好的，但序列化方式很多，两者没有太大的关系。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2365" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2365" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-04 10:44:10</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/545864190001966102200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7839242/articles" target="_blank">                                                         <div class="name l">所相虚妄</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2930191/articles" target="_blank">                                                                 <div class="name l">洗衣粉1</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     他自己实现了那个接口啊                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2381" data-name="所相虚妄">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2381" data-uid="7839242" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-05 12:39:26</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/2423625/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/587396520001024803670367-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/2423625/articles" target="_blank">                                                         <div class="name l">wwwwwwei</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2930191/articles" target="_blank">                                                                 <div class="name l">洗衣粉1</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     ArrayList里面的readObject和writeObject方法了解一下？？                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2523" data-name="wwwwwwei">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2523" data-uid="2423625" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-16 11:30:53</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/3395084/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/5c413a110001e57602250225-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/3395084/articles" target="_blank">                                         <div class="name l">Sicimike</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     大佬，ArrayList中存储数据的数组为啥是Object[]，而不是E[]。是因为泛型在1.5才引入，而ArrayList在1.2就有了吗？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2539">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2539">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2539" data-uid="3395084" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-28</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3395084/articles" target="_blank">                                                                 <div class="name l">Sicimike</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     你分析的很有道理的。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2320" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2320" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-31 12:55:27</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/5795443/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d6cecf1000113ae09700970-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/5795443/articles" target="_blank">                                                         <div class="name l">少为</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3395084/articles" target="_blank">                                                                 <div class="name l">Sicimike</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     也许还有另外一个原因，Java是不支持创建泛型数组的 。 当然可以创建Object数组然后强转为E[]。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2572" data-name="少为">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2572" data-uid="5795443" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-20 19:31:58</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/3526435/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/57641a4f0001e2c803840384-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/3526435/articles" target="_blank">                                         <div class="name l">树上有_云</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     size 不是当前数组的大小吧，而是元素的个数                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2455">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2455">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2455" data-uid="3526435" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-24</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/545845e900013e3e02200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                                         <div class="name l">凉凉那个凉凉</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3526435/articles" target="_blank">                                                                 <div class="name l">树上有_云</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     是的
在所有的列表中都有Capacity 和 size 两个字段
Capacity是指容量
size 是指目前列表中元素个数                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2754" data-name="凉凉那个凉凉">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2754" data-uid="3162691" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-12-05 21:48:36</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7083861/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/545868b60001587202200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7083861/articles" target="_blank">                                                         <div class="name l">慕前端5238027</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3162691/articles" target="_blank">                                                                 <div class="name l">凉凉那个凉凉</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     请问 elementData.length 和size 有什么关系呢？两者相等么
if (minCapacity - elementData.length &amp;gt; 0)
    grow(minCapacity);
如果两者相等，那么minCapacity 总是 size + 1, 总是大于elementData.length， 那么总会执行grow方法                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3782" data-name="慕前端5238027">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3782" data-uid="7083861" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-12 22:37:55</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/3583322/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/57748eca00018abb01000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/3583322/articles" target="_blank">                                         <div class="name l">南船座</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     int oldCapacity = elementData.length;
  // oldCapacity &gt;&gt; 1 是把 oldCapacity 除以 2 的意思
  int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
  // 如果扩容后的值 &lt; 我们的期望值，扩容后的值就等于我们的期望值
  if (newCapacity - minCapacity &lt; 0)
    newCapacity = minCapacity;
newCapacity已经是oldCapacity除以2再加上oldCapacity了
那无论如何都是不存在的newCapacity小于oldCapacity
 if (newCapacity - minCapacity &lt; 0)
    newCapacity = minCapacity;
为什么还要这么写？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2408">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2408">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2408" data-uid="3583322" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-21</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3583322/articles" target="_blank">                                                                 <div class="name l">南船座</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     同学你好，你可以看下 allAll 方法，这个方法引起的扩容，minCapacity 有可能非常大，甚至大于 minCapacity，就会出现 newCapacity - minCapacity 的情况。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2190" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2190" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-21 22:03:54</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/4768694/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/59a2a3b40001e18507680768-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/4768694/articles" target="_blank">                                                         <div class="name l">魅影劲</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3583322/articles" target="_blank">                                                                 <div class="name l">南船座</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     参考07节List源码会问那些问面试 1.2.3 就有这种CASE                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2551" data-name="魅影劲">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2551" data-uid="4768694" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-18 16:12:47</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/5b8ce7610001e66e02000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                         <div class="name l">喵喵喵111</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     向末尾插入数据的时候，确实是o（1），如果刚好在需要扩容的临界点进行添加和删除，那么不就是o(n)了么                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2387">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>3</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2387">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2387" data-uid="7563198" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-19</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                                                 <div class="name l">喵喵喵111</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     是的，正好碰到扩容时候是的。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2189" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2189" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-21 22:00:13</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/4768694/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/59a2a3b40001e18507680768-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/4768694/articles" target="_blank">                                                         <div class="name l">魅影劲</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                                                 <div class="name l">喵喵喵111</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     根据均摊时间复杂度分析,当我们添加到最后一个元素时，如果此时再往里添加一个元素，那么就将进行数组的扩容操作。这次扩容的算法复杂度为O(n),此时我们就要用到均摊复杂度分析法，前面n次操作耗费时间总共为n,第n+1次操作耗费时间为n,相当于执行n+1次操作耗费的时间为2n,那么平均来看，我们每次操作其实耗费的时间为2，他仍然是一个O(1)级别的算法。在这里我把一次线性操作(第n+1次)的复杂度均摊到前面n次操作中。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2550" data-name="魅影劲">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2550" data-uid="4768694" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-18 15:23:12</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/5b8ce7610001e66e02000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                                         <div class="name l">喵喵喵111</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/4768694/articles" target="_blank">                                                                 <div class="name l">魅影劲</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     那如果我在扩容以后立马缩容。就在这个临界点来回添加删除，那时间复杂度不就变成了on了么                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2552" data-name="喵喵喵111">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2552" data-uid="7563198" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-11-18 16:36:02</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                           <div class="btn-moreReply js-more-reply" data-id="2387">                                     点击展开后面 <span>2</span> 条                                 </div>                                                      </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/5b8ce7610001e66e02000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                         <div class="name l">喵喵喵111</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，如果数组刚好处于扩容的临界点，这时候进行数组的增加，再减少，每次的复杂度都会为o(n)，并不是所说的o(1)呀                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2386">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>2</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2386">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2386" data-uid="7563198" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-19</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/1964095/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5458674e0001e87402200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/1964095/articles" target="_blank">                                                         <div class="name l">dengweiqiang</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                                                 <div class="name l">喵喵喵111</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     ArrayList根本就没有缩容这回事情啊，你remove数据，只是移动数据并没有改变数组的大小，所以只有扩容，没有缩容                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2834" data-name="dengweiqiang">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2834" data-uid="1964095" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-12-10 23:10:14</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/3719441/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/54584dc4000118d302200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/3719441/articles" target="_blank">                                                         <div class="name l">神一般的宇</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7563198/articles" target="_blank">                                                                 <div class="name l">喵喵喵111</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     你吃了，如果扩容和缩容倍数相乘为1才有这种情况，ArrayList的扩容是1.5倍，不会出现这种边界情况的。如果扩容是2倍，缩容是0.5，才会有这种情况                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3633" data-name="神一般的宇">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3633" data-uid="3719441" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2020-03-03 11:16:00</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/5171712/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/5e64d83600014ddb07410741-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/5171712/articles" target="_blank">                                         <div class="name l">一起做兄弟</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，想问您一个问题: 就是我们担心的并发下的数据安全问题，有2个概念想跟老师确认下，1、如果不是操作数据库的数据
是那些共享数据 ，此时并发下，多个线程操作它就会存在线程安全问题，
然后如果是在方法内，并发的情况下，多个线程去操作方法内的变量，就不会出现线程安全问题，此时相当于每个线程操作的其实是自己内存里面的东西;

2、第二个的话就是操作数据库中的数据
   
   那么是不是我们想控制线程执行的顺序，来保证数据的安全，一方面是要加上事务去管理，
另外的话可能要一些数据库的锁 , 如 for update排他锁这些，来实现我们的需要；

3、所以java层面的如sychronized(轻量锁)等 和 数据事务锁其实是2个概念吧，一个是Java层面的，一个是数据库层面的，2者并没有啥联系，

  所以，老师，请教您一下，我分析的概念对嘛？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2381">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2381">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2381" data-uid="5171712" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-18</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/5171712/articles" target="_blank">                                                                 <div class="name l">一起做兄弟</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     分析对的哈，不过我们很少使用 for update 锁，数据库资源本来就很紧张，使用数据库会加剧数据库资源紧张的局面，一般我们都用分布式 redis 锁 +  数据库版本号来解决并发请求的问题。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2166" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2166" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-19 10:40:34</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/5171712/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5e64d83600014ddb07410741-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/5171712/articles" target="_blank">                                                         <div class="name l">一起做兄弟</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <div class="author-mark l"></div>                                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                                 <div class="name l">文贺</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     懂了，谢谢老师，哈哈                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2170" data-name="一起做兄弟">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2170" data-uid="5171712" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-19 13:56:44</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6261517/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/533e4c3300019caf02000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6261517/articles" target="_blank">                                         <div class="name l">威先森</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     迭代器中remove方法不能单独调用的，必须先调用next方法才能给lastRet变量赋值。好像场景正常也都是先next取出值，满足条件才remove的，源码的设计真的是返璞归真                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2307">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>2</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2307">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2307" data-uid="6261517" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-12</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6261517/articles" target="_blank">                                                                 <div class="name l">威先森</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     是的，remove 方法有校验的。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2122" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2122" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-14 12:45:51</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/7851285/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/5ce0c54e0001dede05600560-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7851285/articles" target="_blank">                                         <div class="name l">Doubj</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，2.7有个疑问。当ArrayList是方法内的局部变量时，是没有线程安全的问题的，但我在学JVM内存模型中有学到对象实例都是存在线程共享的JAVA堆中的，修改的都是同一个对象实例，这样也没有线程安全问题吗？或者说老师能具体举一下具体情境ArrayList下线程安全的例子吗？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2236">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2236">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2236" data-uid="7851285" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-10-08</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7851285/articles" target="_blank">                                                                 <div class="name l">Doubj</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     同学你好，方法中的局部变量是肯定没有安全的问题的，除非你把局部变量用引用传值给多个子线程。
方法中的局部变量是属于每个线程栈，线程栈之间都是隔离的，所以不会共享资源，也不会有线程安全问题，论证的话，也很简单，你看高并发的互联网公司，方法中的局部变量使用时从不加锁，也不考虑其线程安全就清楚了哈。
具体场景你看下 《18 场景集合：并发 List、Map 的应用场景》这章，其中的 flowMap 是共享变量，有线程安全的问题。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2015" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2015" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-08 19:21:32</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7851285/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/5ce0c54e0001dede05600560-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7851285/articles" target="_blank">                                                         <div class="name l">Doubj</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <div class="author-mark l"></div>                                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                                 <div class="name l">文贺</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     明白了~谢谢老师:)                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="2030" data-name="Doubj">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="2030" data-uid="7851285" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-09 10:31:49</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7563808/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5458659400017f0802190220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7563808/articles" target="_blank">                                                         <div class="name l">慕设计7491587</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7851285/articles" target="_blank">                                                                 <div class="name l">Doubj</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     虽然对象实例放在堆中，堆也是共享的，但是线程栈中的局部变量只存在栈帧中的局部变量表中，和其他线程是隔离的，所以其他线程中的变量是引用不到堆中的该对象实例的。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="3822" data-name="慕设计7491587">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="3822" data-uid="7563808" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">7天前</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/1010756/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/545f2fa50001ea4f01000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/1010756/articles" target="_blank">                                         <div class="name l">鹏飞天下</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     ArrayList删除元素的时间复杂度怎么能是O（1）呢？他不是有元素的移动吗？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="2076">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>2</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="2076">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="2076" data-uid="1010756" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-25</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/4010867/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/57ddfe1700013e1401000100-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/4010867/articles" target="_blank">                                                         <div class="name l">Secondary4010867</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/1010756/articles" target="_blank">                                                                 <div class="name l">鹏飞天下</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     应该是O(n)吧                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1871" data-name="Secondary4010867">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1871" data-uid="4010867" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-26 07:44:47</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/5409387/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5e5d8c350001127507400574-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/5409387/articles" target="_blank">                                                         <div class="name l">SodaGreen_</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/1010756/articles" target="_blank">                                                                 <div class="name l">鹏飞天下</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     我也觉得老师讲错了吧这块，还有如果扩容的话，要copy数组，怎么会是o（1）&lt;br /&gt;                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1908" data-name="SodaGreen_">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1908" data-uid="5409387" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-28 06:10:20</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/1010756/articles" target="_blank">                                                                 <div class="name l">鹏飞天下</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     同学你好，这个在下面的回复中有提到哈，文中的表达是：只需要根据数组索引，直接新增和删除，所以时间复杂度是 O (1)，说的是可以直接根据数组的索引，找到数组的位置，这个时间复杂度是 O (1)。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1972" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1972" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-10-08 11:50:33</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                           <div class="btn-moreReply js-more-reply" data-id="2076">                                     点击展开后面 <span>2</span> 条                                 </div>                                                      </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/5d6a818e0001aabb09600960-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                         <div class="name l">licly</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     3、还是newCapacity方法
if (minCapacity &lt; 0) // overflow
    throw new OutOfMemoryError();
这种情况是Integer循环回去了吗，比如到达Integer.MAX_VALUE，继续增加，就会变成负数

4、既然jvm只能分配MAX_ARRAY_SIZE个长度，那hugeCapacity(int minCapacity)方法中为什么又做了
(minCapacity &gt; MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE这样的判断

本来想一次贴代码来着，结果留言有字数限制，问题还分了两次提问，所以代码就不贴了，麻烦老师了                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1946">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1946">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1946" data-uid="8096709" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-16</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                                 <div class="name l">licly</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     3：不是循环回去了，Integer.MAX_VALUE 的值是 2147483647，继续 +1 就会变成 -2147483648。
4：Integer.MAX_VALUE 是 int 类型的大小限制，不是 JVM 限制，判断只是正常的业务校验哈。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1762" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1762" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-17 18:50:55</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d6a818e0001aabb09600960-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                         <div class="name l">licly</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <div class="author-mark l"></div>                                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                                 <div class="name l">文贺</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     第四个问题：那ArrayList的最大长度就是Integer.MAX_VALUE，不是MAX_ARRAY_SIZE吧，这样理解对吗                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1765" data-name="licly">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1765" data-uid="8096709" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-17 21:44:16</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                                 <div class="name l">licly</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     是的，最大能到 Integer.MAX_VALUE                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1780" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1780" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-18 21:28:00</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                           <div class="btn-moreReply js-more-reply" data-id="1946">                                     点击展开后面 <span>6</span> 条                                 </div>                                                      </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/5d6a818e0001aabb09600960-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                         <div class="name l">licly</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，请教几个问题：
1.9中
1、grow方法【line241~243】为什么要将size+1呢
代码：
private Object[] grow() {
    return grow(size + 1);
}
2、newCapacity方法中【line254~268】
 if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA)，这种情况下minCapacity肯定是1呀，Math.max(DEFAULT_CAPACITY, minCapacity)这行代码使用max方法的作用是什么，感觉完全可以不用呀                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1945">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1945">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1945" data-uid="8096709" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-16</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                                 <div class="name l">licly</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     第一个问题，你说的源码我完全找不到哈。第二个问题，当使用入参数是 Collection&amp;lt;? extends E&amp;gt; c 的构造器的时候，minCapacity 不一定是 1哦。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1761" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1761" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-17 18:41:29</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d6a818e0001aabb09600960-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                         <div class="name l">licly</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <div class="author-mark l"></div>                                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                                 <div class="name l">文贺</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     第二个问题：满足if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA)这个条件的只有无参构造的list吧，如果是指定元素的构造public ArrayList(Collection&amp;lt;? extends E&amp;gt; c) ，elementData是不满足这个条件的                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1764" data-name="licly">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1764" data-uid="8096709" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-17 21:42:35</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/8096709/articles" target="_blank">                                                                 <div class="name l">licly</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     你好 同学，是的哈。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1779" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1779" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-18 21:24:38</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/4342740/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/581afe470001f35801000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/4342740/articles" target="_blank">                                         <div class="name l">power_cheng4342740</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     钻个牛角尖: 在使用迭代器或增强for循环时, 如果数组大小被改变未必会抛异常.比如在迭代器中使用迭代器的remove()方法, 或在增强for循环中增删元素后就结束了当前循环                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1893">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>4</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1893">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1893" data-uid="4342740" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-12</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/4342740/articles" target="_blank">                                                                 <div class="name l">power_cheng4342740</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     很棒哈，是的，看场景的，这个在 《List 源码会问哪些面试题》中有详细描述。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1698" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1698" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-12 18:59:08</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/2232970/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/55c48a0b0001180301000100-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/2232970/articles" target="_blank">                                                         <div class="name l">贰零一贰</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/4342740/articles" target="_blank">                                                                 <div class="name l">power_cheng4342740</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     哈哈  看评论又学到一招！                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1718" data-name="贰零一贰">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1718" data-uid="2232970" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-16 19:04:48</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/4342740/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/581afe470001f35801000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/4342740/articles" target="_blank">                                         <div class="name l">power_cheng4342740</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     准确的说成员变量size并不是表示当前数组的大小, 它表示的是当前集合元素的个数.举个例子:第一次向集合中插入一个元素后, 数组大小为10, 而size值为1                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1884">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1884">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1884" data-uid="4342740" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-12</div>                                 </div>                             </div>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/7388288/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/5c0e56ce0001436606400640-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/7388288/articles" target="_blank">                                         <div class="name l">和尚码代码</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     在GitHub中，文章源代码 ArrayListDemo中testBatchInsert 注释没有修改，应该是单个新增和批量新增                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1834">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1834">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1834" data-uid="7388288" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-10</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7388288/articles" target="_blank">                                                                 <div class="name l">和尚码代码</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     收到，demo 注释已修改，代码已提交。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1679" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1679" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-11 12:37:10</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/1997951/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5333a1200001ff5602000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/1997951/articles" target="_blank">                                                         <div class="name l">zky</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/7388288/articles" target="_blank">                                                                 <div class="name l">和尚码代码</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     请问github源码 在哪里可以找到呢？ url路径是啥呢                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1701" data-name="zky">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1701" data-uid="1997951" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-13 18:37:36</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6746843/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/5333a24400017ccd02000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6746843/articles" target="_blank">                                         <div class="name l">qq_蔡骚哥_0</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师厉害哦，学到很多。                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1787">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>2</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1787">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1787" data-uid="6746843" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-07</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6746843/articles" target="_blank">                                                                 <div class="name l">qq_蔡骚哥_0</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     感谢，你也可以的哈。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1610" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1610" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-08 10:05:30</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/8105561/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/54584ef20001deba02200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/8105561/articles" target="_blank">                                         <div class="name l">weixin_慕哥3371281</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     内容细致，条理也比较清晰，真心不错。                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1767">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>2</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1767">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1767" data-uid="8105561" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-05</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/8105561/articles" target="_blank">                                                                 <div class="name l">weixin_慕哥3371281</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     感谢支持，你的支持是对文贺最大的鼓励。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1600" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1600" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-06 12:49:47</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6524787/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/5333a01a0001ee5302000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6524787/articles" target="_blank">                                         <div class="name l">慕设计6098684</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     「初始化时，如果你给定的大小 &lt; 10，那么初始化大小是按照 10 计算的，并不是你给定的值；」
代码备注改了，总结没改噢                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1739">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1739">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1739" data-uid="6524787" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-03</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6524787/articles" target="_blank">                                                                 <div class="name l">慕设计6098684</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     好的，收到，已订正。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1570" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1570" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-04 14:16:48</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6849459/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/5458476500014e6402200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6849459/articles" target="_blank">                                         <div class="name l">慕沐3552275</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     "所以当你在初始化数组大小时，如果你给定的初始化大小是 4，其实还是拿着 10 去计算的"这个地方不太理解，这部分的if条件是elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA。如果给定初始化大小的话那么elementData就不会是DEFAULTCAPACITY_EMPTY_ELEMENTDATA了。                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1703">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>3</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1703">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1703" data-uid="6849459" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-02</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6849459/articles" target="_blank">                                                                 <div class="name l">慕沐3552275</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     火眼金睛，感谢，已订正，快微信联系我，给你发个大红包。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1530" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1530" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-03 09:39:21</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/2781999/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img.mukewang.com/545861d500015cc602200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/2781999/articles" target="_blank">                                         <div class="name l">langlangliu</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     这里似乎是不对的 【如果你给定的初始化大小是 4，其实还是拿着 10 去计算的】
文档内的代码: 【【【
private void ensureCapacityInternal(int minCapacity) {
  //如果是空数组，就从最小容量和默认容量10之间取最大值
  //所以当你在初始化数组大小时，如果你给定的初始化大小是 4，其实还是拿着 10 去计算的
  if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
    minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);
  }
  ...省略...
}
】】】
这里如果初始化大小为4, 上面的if不会执行(此时 elementData = new Object[4]), 之后扩容还是到6, 9, 14...                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1702">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1702">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1702" data-uid="2781999" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-02</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2781999/articles" target="_blank">                                                                 <div class="name l">langlangliu</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     火眼金睛，感谢，已订正，快微信联系我，给你发个大红包。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1529" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1529" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-03 09:39:18</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/1148542/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/54a404600001811801000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/1148542/articles" target="_blank">                                         <div class="name l">用户1148542</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     如果我构造函数中传递的参数是4
   this.elementData = new Object[initialCapacity];
而这个时候size 值不应该变成4么 只是上面的数组里面存储的都是null而已                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1694">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1694">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1694" data-uid="1148542" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-09-01</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/6849459/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5458476500014e6402200220-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/6849459/articles" target="_blank">                                                         <div class="name l">慕沐3552275</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/1148542/articles" target="_blank">                                                                 <div class="name l">用户1148542</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     size是0，数组长度是4，是两个概念吧                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1504" data-name="慕沐3552275">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1504" data-uid="6849459" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-02 12:45:28</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/1148542/articles" target="_blank">                                                                 <div class="name l">用户1148542</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     initialCapacity 标识初始化容量大小。size 是实际大小，是两个概念哈。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1511" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1511" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-02 13:23:46</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6849459/articles" target="_blank">                                                                 <div class="name l">慕沐3552275</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     棒，你说的是对的哈。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1512" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1512" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-02 13:23:55</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6267911/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img2.mukewang.com/5c53bdd80001564704120728-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6267911/articles" target="_blank">                                         <div class="name l">小森森的森</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，没有看懂这段代码，为什么要!= Object[].class?
 if (elementData.getClass() != Object[].class) {
            elementData = Arrays.copyOf(elementData, size, Object[].class);
        }                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1635">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1635">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1635" data-uid="6267911" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-28</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6267911/articles" target="_blank">                                                                 <div class="name l">小森森的森</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     这是因为 elementData 是个 Object 的数组哈。但入参的 Collection&amp;lt;? extends E&amp;gt; c 却不定是 Object 的数组，所以需要转化下。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1477" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1477" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-08-31 09:05:39</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/2584699/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/5ad5aad10001108a02000200-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/2584699/articles" target="_blank">                                         <div class="name l">wsdevotion</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     请问什么时候能更新完呀                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1626">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1626">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1626" data-uid="2584699" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-28</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7789740/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5b8cd091000154e002000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7789740/articles" target="_blank">                                                         <div class="name l">初一</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/2584699/articles" target="_blank">                                                                 <div class="name l">wsdevotion</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     同学你好  本专栏是每周二、周四进行更新,感谢支持 ^^                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1519" data-name="初一">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1519" data-uid="7789740" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-02 15:48:24</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/4901550/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img4.mukewang.com/5458475800015cb202200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/4901550/articles" target="_blank">                                         <div class="name l">慕粉2112063460</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     04章，是不是还没发布？                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1620">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1620">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1620" data-uid="4901550" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-28</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7789740/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5b8cd091000154e002000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7789740/articles" target="_blank">                                                         <div class="name l">初一</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/4901550/articles" target="_blank">                                                                 <div class="name l">慕粉2112063460</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     是的  明天更新^^                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1422" data-name="初一">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1422" data-uid="7789740" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-08-28 16:49:52</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/3120165/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/5458502c00012d4a02200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/3120165/articles" target="_blank">                                         <div class="name l">道临</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     老师，remove时后面的元素不是都向前移吗，最坏不应该是O(n)级复杂度吗，为什么文中说是O(1)                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1615">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1615">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1615" data-uid="3120165" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-28</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img1.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3120165/articles" target="_blank">                                                                 <div class="name l">道临</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     文中说的是查找到要操作的数据的时间复杂度哈，根据索引位置直接定位数据。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1431" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1431" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-08-28 22:48:34</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/7808597/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img3.mukewang.com/533e4c910001a72d02000200-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/7808597/articles" target="_blank">                                                         <div class="name l">慕神9346227</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/3120165/articles" target="_blank">                                                                 <div class="name l">道临</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     我也这么觉得，插入和删除应该是O(n)吧                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1571" data-name="慕神9346227">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1571" data-uid="7808597" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-04 14:20:48</div>                                                 </div>                                             </div>                                         </li>                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/1864581/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img2.mukewang.com/5acf4c3a000126d613001300-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <a href="http://www.imooc.com/u/1864581/articles" target="_blank">                                                         <div class="name l">小明同学爱思考</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <div class="author-mark l"></div>                                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                                 <div class="name l">文贺</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     但是文中表述不是这样的                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1581" data-name="小明同学爱思考">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1581" data-uid="1864581" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-09-05 09:19:29</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                           <div class="btn-moreReply js-more-reply" data-id="1615">                                     点击展开后面 <span>2</span> 条                                 </div>                                                      </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/5054459/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img3.mukewang.com/58cd44c60001164e01000100-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/5054459/articles" target="_blank">                                         <div class="name l">Gitcommit</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     初始化那边是不是少了一个指定大小初始化的
 public ArrayList(int initialCapacity) {
        if (initialCapacity &gt; 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            throw new IllegalArgumentException("Illegal Capacity: "+
                                               initialCapacity);                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1614">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>0</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1614">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1614" data-uid="5054459" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-28</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/5054459/articles" target="_blank">                                                                 <div class="name l">Gitcommit</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     棒，篇幅有限哈，选取了部分。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1432" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1432" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-08-28 22:50:36</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6798227/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/545865da00012e6402200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6798227/articles" target="_blank">                                         <div class="name l">蓝山帝景</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     正在准备面试中，刷下源码对于技术面还可以放心一点，还挺全面的，工作中经常用到的知识点都能了解到                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1589">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1589">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1589" data-uid="6798227" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-27</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6798227/articles" target="_blank">                                                                 <div class="name l">蓝山帝景</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     嗯嗯，基本都是工作中常用的点，希望你面试成功，平步青云。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1386" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1386" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-08-27 19:18:03</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                                                       <li class="comment clearfix hide">                                          <a href="http://www.imooc.com/u/6798226/articles" target="_blank">                             <div class="head-img l" style="background-image:url(//img1.mukewang.com/545863c10001865402200220-100-100.jpg)"></div>                         </a>                         <div class="comment-detail l">                             <div class="hoverDisplay">                                 <div class="com-author clearfix">                                                                                                               <a href="http://www.imooc.com/u/6798226/articles" target="_blank">                                         <div class="name l">富国沪深</div>                                     </a>                                                                                                                                                                                              </div>                                 <div class="com-content">                                     一直对于各个底层的实现很好奇，我觉得线程池、线程、集合、队列现在用的很多，看着老师这门课程写的很实用了，学到了 打卡~~                                 </div>                                 <div class="com-other clearfix">                                                                              <!-- 没点过赞 -->                                         <div class="btn-agree js-agree l" data-commentid="1588">                                                                                  <i class="imv2-thumb_up"></i>                                             <span>1</span>                                         </div>                                                                                                               <div class="btn-reply l js-reply" data-replyid="1588">回复</div>                                     <!-- 没登录不显示举报 -->                                                                              <div class="btn-report l js-tip-off comment-report" data-id="1588" data-uid="6798226" data-src="/read/47/article/847" data-type="15">举报</div>                                                                          <div class="time r">2019-08-27</div>                                 </div>                             </div>                                                              <ul class="replys-list js-replys-list">                                                                              <li class="reply clearfix">                                             <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                 <div class="head-img l" style="background-image:url(//img4.mukewang.com/5d5649e600012b5c02000215-100-100.jpg)"></div>                                             </a>                                             <div class="reply-detail l">                                                 <div class="rep-author clearfix">                                                                                                          <div class="author-mark l"></div>                                                                                                          <a href="http://www.imooc.com/u/8062574/articles" target="_blank">                                                         <div class="name l">文贺</div>                                                     </a>                                                                                                                                                                   <div class="to l clearfix">                                                             <span class="l">回复</span>                                                                                                                          <a href="http://www.imooc.com/u/6798226/articles" target="_blank">                                                                 <div class="name l">富国沪深</div>                                                             </a>                                                         </div>                                                                                                      </div>                                                 <div class="rep-content">                                                     一起加油，共同进步。                                                 </div>                                                 <div class="rep-other clearfix">                                                     <div class="btn-reply l js-reply" data-replyid="1433" data-name="文贺">回复</div>                                                                                                              <div class="btn-report l js-tip-off reply-report" data-id="1433" data-uid="8062574" data-src="/read/47/article/847" data-type="16">举报</div>                                                                                                          <div class="time r">2019-08-28 22:51:09</div>                                                 </div>                                             </div>                                         </li>                                                                      </ul>                                                                                   </div>                     </li>                              </ul>                              <div class="btn-leftComments js-getLeftComments">                     <div class="mask"></div>                     <p>点击展开剩余评论</p>                 </div>                           </div>  </div>

                <div class="bottom-line">
                    <div class="line"></div>
                    <div class="bottom-tip">千学不如一看，千看不如一练</div>
                    <div class="line"></div>
                </div>
            </div>
            <div class="right_con js-right_con r">
                                                    <div class="item">
                                                    <!-- 已买且开放 或者可以试读 -->
                            <a href="http://www.imooc.com/read/47/article/846">
                                                    <p>
                                <i class="imv2-arrow3_l"></i>
                            </p>
                            <p>上一节</p>
                        </a>
                    </div>
                                                    <div class="item">
                                                    <!-- 已买且开放 或者可以试读 -->
                            <a href="http://www.imooc.com/read/47/article/848">
                                                    <p>
                                <i class="imv2-arrow3_r"></i>
                            </p>
                            <p>下一节</p>
                        </a>
                    </div>
                                                
                
                <div class="coments item">
                    <a href="http://www.imooc.com/read/47/article/847#coments_con">
                        <p>
                            <i class="imv2-chat_bubble
                            "></i>
                        </p>
                        <p>留言</p>
                    </a>
                </div>
                <div class="share js-hover item">
                    <p>
                        <i class="imv2-share"></i>
                    </p>
                    <p>分享</p>
                    <div class="bdsharebuttonbox share-box hover bdshare-button-style0-16" data-bd-bind="1585061968474">
                        <a href="http://www.imooc.com/read/47/article/847#" class="bds_weixin imv2-weixin" data-cmd="weixin" title="分享到微信">
                        </a>
                        <a href="http://www.imooc.com/read/47/article/847#" class="bds_tsina imv2-weibo" data-cmd="tsina" title="分享到新浪微博">
                        </a>
                        <a href="http://www.imooc.com/read/47/article/847#" class="bds_qzone imv2-qq" data-cmd="qzone" title="分享到QQ空间">
                        </a>
                    </div>
                </div>
                <div class="app js-hover item">
                    <p>
                        <i class="imv2-appdownload"></i>
                    </p>
                    <p>手机<br>阅读</p>
                    <div class="app-box hover">
                        <div class="qrcode" id="qrcode"><canvas width="96" height="96"></canvas></div>
                        <p>扫一扫 手机阅读</p>
                    </div>
                </div>
                <!-- 已买并且只有13和14才显示助理琪琪 -->
                
                

                                    <div class="zhuli-con item js-jiaqun">
                        <div class="icon">
                            <i class="imv2-set-sns"></i>
                        </div>
                        <div class="title">进群</div>
                    </div>
                                <div class="item goto-top">
                    <a href="JavaScript:;" class="js-backTop">
                        <p>
                            <i class="imv2-chevrons-up
                            "></i>
                        </p>
                        <p>回顶部</p>
                    </a>
                </div>
            </div>
            <div class="top-buy-fixed js-top-buy-fixed clearfix hasbuy animate">
                                    <!-- 买过的阅读 -->
                    <div class="map">
                        <a href="http://www.imooc.com/read" target="_blank"><i class="imv2-feather-o"></i></a>
                        <a href="http://www.imooc.com/read/47" target="_blank">面试官系统精讲Java源码及大厂真题</a>
                        <a href="http://www.imooc.com/read/47/article/847" target="_blank">
                            <span>
                                / 2-1 05 ArrayList 源码解析和设计思路   
                            </span>
                        </a>
                    </div>
                
            </div>
            <div class="modal-mask js-mask">
                <!-- <div class="modal-close js-close">
                    <i class="imv2-close"></i>
                </div> -->
                <!-- <div class="modal-category js-modal-category">
                    <div class="title-box">
                        <div class="img" style="background-image:url(//img4.sycdn.imooc.com/5d634f730001681c05400720.jpg)"></div>
                        <span class="title">05 ArrayList 源码解析和设计思路   </span>
                        <a class="toDetail r" href="/read/47" target="_blank">进入课程详情 ></a>
                    </div>
                                        <span class="js-sort-chapter sort-chapter">排序</span>
                                        <div class="item-box js-item-box">
                    </div>
                </div> -->
            </div>

        </div>
    </div>
</div>

<div class="modal modal-jiaQun-new hide" id="modal-jiaQun">
    <div class="inner" style="">
        <div class="modal-close js-close-jiaQun">
            <i class="imv2-close"></i>
        </div>
        <div class="content">
            <img src="./1_files/5e4a023400015aa205250515.jpg">
            <div class="right-info">
                <div class="title">
                    扫码加入慕课Java核心用户群
                </div>
                <div class="desc">
                                            <p class="mb6">验证信息：<span id="joincode">1909040934116582</span><span class="copy js-copy-joincode">复制</span></p>
                                        <p class="mb6">QQ讨论群号：906695467</p>
                                            <p>QQ群URL：<a href="https://jq.qq.com/?_wv=1027&amp;k=5ZvtQ5P" target="_blank">点击访问</a></p>
                                    </div>
            </div>
            <p class="tip">若遇到搜索不到QQ群或加群失败，请联系客服邮箱:kf@imooc.com</p>
        </div>
    </div>
</div>
 
<!-- 专栏介绍页专栏评价 -->
<script type="text/template" id="allcomments-tpl">
    {@if data.loadmoreTpl }
    <!-- 下拉加载更多模板 -->
        {@each data.list as item}
        <li class="clearfix">
            <a href="/u/${item.user.uid}" target="_blank">
                <div class="img l" style="background-image:url(${item.user.img})"></div>
            </a>
            <div class="text l">
                <div class="right-top">
                    <a href="/u/${item.user.uid}" target="_blank">
                        <span>${item.user.nickname}</span>
                    </a>
                    $${item.comment_score|compute_stars}
                </div>
                <div class="comment">
                    ${item.content}
                </div>
                {@if item.reply }
                    <p class="tip">作者回复</p>
                    <p class="reply">
                        $${item.reply}
                    </p>
                {@/if}
            </div>
        </li>
        {@/each}
    {@/if}

    {@if data.hasbuy }
        {@if !data.my }
        <!-- 购买未评价 -->
        <div class="inputCon">
            <div class="placeHolder">
                <div class="count js-count">0/300</div>
                <textarea id="comment" placeholder="写下你对该课程的评价"></textarea>
                <p class="err-tip">评论内容不少于3个字！</p>
            </div>
            <div class="score clearfix">
                <div class="part l">
                    <p>内容实用</p>
                    <p class="js-score1">
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                    </p>
                </div>
                <div class="part l">
                    <p>简洁易懂</p>
                    <p class="js-score2">
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                    </p>
                </div>
                <div class="part l">
                    <p>逻辑清晰</p>
                    <p class="js-score3">
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                        <i class="imv2-star js-star active"></i>
                    </p>
                </div>

                <div class="submit js-submit r">
                    提交
                </div>
                
            </div>
            
        </div>
    {@else}
        <!-- 购买已经评价 -->
        <div class="myComment">
            <p class="title">我的评价</p>
            <div class="clearfix info">
                <a href="/u/${data.my.user.uid}" target="_blank">
                    <div class="img l" style="background-image:url(${data.my.user.img})"></div>
                </a>
                <div class="text l">
                    <div class="right-top">
                        <a href="/u/${data.my.user.uid}" target="_blank">
                            <span>${data.my.user.nickname}</span>
                        </a>
                        $${data.my.comment_score|compute_stars}
                    </div>
                    <div class="comment">
                        ${data.my.content}
                    </div>
                    {@if data.my.reply }
                        <p class="tip">作者回复</p>
                        <p class="reply">
                            $${data.my.reply}
                        </p>
                    {@/if}
                </div>
            </div>
        </div>
    {@/if}
    <div class="top clearfix">
        <p class="title l">全部评价</p>
    </div>
    {@/if}
    <ul class="js-loadMore">
        {@each data.list as item}
        <li class="clearfix">
            <a href="/u/${item.user.uid}" target="_blank">
                <div class="img l" style="background-image:url(${item.user.img})"></div>
            </a>
            <div class="text l">
                <div class="right-top">
                    <a href="/u/${item.user.uid}" target="_blank">
                        <span>${item.user.nickname}</span>
                    </a>
                    $${item.comment_score|compute_stars}
                </div>
                <div class="comment">
                    ${item.content}
                </div>
                {@if item.reply }
                    <p class="tip">作者回复</p>
                    <p class="reply">
                        $${item.reply}
                    </p>
                {@/if}
            </div>
        </li>
        {@/each}
    </ul>
    {@if !data.loadmoreTpl}
    <!-- 只在第一页加载一次否则每次都是固定的data-page 2  --> 
    <div class="feed-loading js-feed-loading" data-page="2">
        <i class='imv2-loading'></i><span>正在加载中</span>
    </div>
    {@/if}
</script>
<!-- 专栏介绍页底部三条评价 -->
<script type="text/template" id="bottomcomments-tpl">
    {@each data as item}
    <li class="clearfix">
        <a href="/u/${item.user.uid}" target="_blank">
            <div class="img l" style="background-image:url(${item.user.img})"></div>
        </a>
        <div class="text l">
            <div class="right-top">
                <a href="/u/${item.user.uid}" target="_blank">
                    <span>${item.user.nickname}</span>
                </a>
                $${item.comment_score|compute_stars}
            </div>
            <div class="comment">
                ${item.content}
            </div>
            {@if item.reply }
                <p class="tip">作者回复</p>
                <p class="reply">
                    $${item.reply}
                </p>
            {@/if}
        </div>
    </li>
    {@/each}
</script>
<!-- 专栏阅读页弹层目录和介绍页页面目录 -->
<script type="text/template" id="catalog-tpl">
{@if data.list.length}
    {@each data.list as item,i}
    <div class="item">
        {@if data.structure_mode == "1" }
            <!-- 有章模式 -->
            <!-- 小节模式下 不显示该章标题且所有小节数据均放在list[0]中 -->
            <div class="section clearfix">
                <p class="sec_name l">$${item.title}</p>
                <!-- <p class="total r">共 ${item.count} 小节内容</p> -->
            </div>
        {@/if}
        <ul>
        {@each item.list as it, i}
            {@if it.is_open != "0" }
            <li class="gray" style="display: none;">
            {@else if data.isBuy == 1 && it.is_clock_in == 1}
            <li class="has-learned">
            {@else}
            <li>
            {@/if}
                {@if data.isBuy == 0 }
                    {@if it.is_open == 0 }
                        <!-- 开放 -->
                        {@if it.is_pay == 0 }
                            <a href="/read/${data.column_id}/article/${it.id}">
                        {@else}
                            <a href="javascript:;" class="js-lock">
                        {@/if}
                    {@else}
                        <a href="javascript:;" class="js-notopen cant">
                    {@/if}
                {@else}
                    {@if it.is_open == 0 }
                    <!-- 开放 -->
                        <a href="/read/${data.column_id}/article/${it.id}">
                    {@else}
                        <a href="javascript:;" class="js-notopen cant">
                    {@/if}
                {@/if}
                    <div class="articleName">
                        $${it.title}
                    </div>
                    <div class="info">
                        {@if it.is_open == 0 }
                        <!-- 开放 -->
                            <!-- <span>${it.word_count} 个文字</span> 
                            <i class="imv2-dot_samll"></i>
                            <span>${it.view_num} 次阅读</span>-->
                            {@if !data.is_left_menu}
                                <span>${it.open_time_fmt}</span>
                            {@/if}
                            {@if it.in_24hours}
                            <span class="recently-update">最近更新</span>
                            {@/if}
                        {@else}
                        <!-- 创作中 -->
                            <span>即将更新</span>
                        {@/if}
                    </div>

                    {@if data.isBuy == 0 }
                        <!-- 未购买 -->

                        {@if it.is_open == 0 && it.is_pay == 0 }
                            <div class="taste-btn">
                                试读
                            </div>
                        {@else}
                            <div class="lock-btn">
                                <i class="imv2-lock"></i>
                            </div>
                        {@/if}

                    {@else}
                        <!-- 已经购买 -->
                        {@if data.last_chapter == it.id }
                            <div class="last-learn">
                                最近阅读
                            </div>
                        {@else if it.is_clock_in == 1}
                            <div class="last-learn">
                                已学完
                            </div>
                        {@/if}
                    {@/if}
                </a>
                
            </li>
            {@/each}
        </ul>
    </div>
    {@/each}
{@else}
    <p style="margin-top: 20px; text-align: center;">
        暂无开放章节
    </p>
{@/if}
</script>
<!-- 专栏阅读页发布回复 -->
<script type="text/template" id="publishReply-tpl">
    <div class="reply-con">
        <div class="comment-box">
            {@if data.name }
                <textarea id="reply" placeholder="回复 ${data.name}：" maxlength="400"></textarea>
            {@else}
                <textarea id="reply" placeholder="写下你的回复"></textarea>
            {@/if}
            <div class="leftNum js-count">0/400</div>
        </div>
        <p id="feed-error" class="feed-error"></p>
        <div class="captcha-verify-box js-comment-verify-box hide"></div>
        <div class="btn-submit js-submit-reply r">提交</div>
    </div>
    
</script>
<!-- 专栏阅读页发布评论 -->
<script type="text/template" id="publishComment-tpl">
    <div class="df-text">
        <!-- <div id="js-publish-editor-box" class="wd-comment-box"></div> -->
        <div class="comment-box">
            <textarea class="js-comment-content" placeholder="在这里发表下你的想法吧！" maxlength="1000"></textarea>
            <div class="leftNum js-count">0/1000</div>
        </div>
        
        <p id="feed-error" class="feed-error"></p>
        <div class="df-bottom clearfix">
            <div class="captcha-verify-box js-comment-verify-box hide"></div>
            <button id="js-submit" class="comment-btn r">提交</button>
        </div>
    </div>
</script>
<!-- 专栏阅读页底部评论 -->
<script type="text/template" id="comments-tpl">
    <div class="number">精选留言 <span class="js-number">${data.total}</span></div>
    <div class="comments">
        <div class="input-fake js-showcommentModal">
            欢迎在这里发表留言，作者筛选后可公开显示
        </div>
        {@if data.total == 0 }
            <div class="noData">
                <p>
                    <i class="imv2-error_c"></i>
                </p>
                <p>目前暂无任何讨论</p>
            </div>
        {@else}
            <ul class="comments-list js-comments-list">
                {@each data.list as item,i}
                {@if i>10}
                    <li class="comment clearfix hide">
                {@else} 
                    <li class="comment clearfix">
                {@/if}
                        <a href="//www.imooc.com/u/${item.uid}/articles" target="_blank">
                            <div class="head-img l" style="background-image:url(${item.img})"></div>
                        </a>
                        <div class="comment-detail l">
                            <div class="hoverDisplay">
                                <div class="com-author clearfix">
                                    {@if item.uid == data.article_uid}
                                    <div class="author-mark l"></div>
                                    {@/if}
                                    
                                    <a href="//www.imooc.com/u/${item.uid}/articles" target="_blank">
                                        <div class="name l">${item.nickname}</div>
                                    </a>

                                    {@if item.user_type == 2}
                                        <div class="teacher icon l"></div>
                                    {@/if} 
                                    {@if item.is_author == 1}
                                        <div class="writer icon l"></div>
                                    {@/if}       
                                    {@if item.mustar_switch == 1}
                                        <div class="user icon l"></div>
                                    {@/if}
                                    
                                </div>
                                <div class="com-content">
                                    $${item.content}
                                </div>
                                <div class="com-other clearfix">
                                    {@if item.upvoted == 0}
                                        <!-- 没点过赞 -->
                                        <div class="btn-agree js-agree l" data-commentid="${item.id}">
                                    {@else}
                                        <!-- 点过赞的 -->
                                        <div class="btn-has-agree l">
                                    {@/if}
                                            <i class="imv2-thumb_up"></i>
                                            <span>${item.support_num}</span>
                                        </div>
                                    
                                    
                                    <div class="btn-reply l js-reply" data-replyId="${item.id}">回复</div>
                                    <!-- 没登录不显示举报 -->
                                    {@if data.isLogin}
                                        <div class="btn-report l js-tip-off comment-report" data-id="${item.id}" data-uid="${item.uid}" data-src="${data.tip_url}" data-type="15">举报</div>
                                    {@/if}
                                    <div class="time r">${item.create_time}</div>
                                </div>
                            </div>
                            {@if item.comment_num > 0}
                                <ul class="replys-list js-replys-list">
                                    {@each item.replys as it}
                                        <li class="reply clearfix">
                                            <a href="//www.imooc.com/u/${it.uid}/articles" target="_blank">
                                                <div class="head-img l" style="background-image:url(${it.img})"></div>
                                            </a>
                                            <div class="reply-detail l">
                                                <div class="rep-author clearfix">
                                                    {@if it.uid == data.article_uid}
                                                    <div class="author-mark l"></div>
                                                    {@/if}
                                                    <a href="//www.imooc.com/u/${it.uid}/articles" target="_blank">
                                                        <div class="name l">${it.nickname}</div>
                                                    </a>
                                                    {@if !it.to_nickname}

                                                        {@if it.user_type == 2}
                                                            <div class="teacher icon l"></div>
                                                        {@/if}
                                                        {@if it.is_author == 1}
                                                            <div class="writer icon l"></div>
                                                        {@/if}       
                                                        {@if it.mustar_switch == 1}
                                                            <div class="user icon l"></div>
                                                        {@/if}
                                                    {@/if}
                                                    {@if it.to_nickname}
                                                        <div class="to l clearfix">
                                                            <span class="l">回复</span>
                                                            {@if it.to_uid == data.article_uid}
                                                            <div class="author-mark l"></div>
                                                            {@/if}
                                                            <a href="//www.imooc.com/u/${it.father_uid}/articles" target="_blank">
                                                                <div class="name l">${it.to_nickname}</div>
                                                            </a>
                                                        </div>
                                                    {@/if}
                                                </div>
                                                <div class="rep-content">
                                                    ${it.content}
                                                </div>
                                                <div class="rep-other clearfix">
                                                    <div class="btn-reply l js-reply" data-replyId="${it.id}" data-name="${it.nickname}">回复</div>
                                                    {@if data.isLogin}
                                                        <div class="btn-report l js-tip-off reply-report" data-id="${it.id}" data-uid="${it.uid}" data-src="${data.tip_url}" data-type="16">举报</div>
                                                    {@/if}
                                                    <div class="time r">${it.create_time}</div>
                                                </div>
                                            </div>
                                        </li>
                                    {@/each}
                                </ul>
                            {@/if}
                            {@if item.comment_num > 3}
                                <div class="btn-moreReply js-more-reply" data-id="${item.id}">
                                    点击展开后面 <span>${item.comment_num - 3}</span> 条
                                </div>
                            {@/if}
                        </div>
                    </li>
                {@/each}
            </ul>
            {@if data.total > 10 }
                <div class="btn-leftComments js-getLeftComments">
                    <div class="mask"></div>
                    <p>点击展开剩余评论</p>
                </div>
            {@/if}
        {@/if}
    </div>

</script>
<!-- 专栏阅读 单个 评论 -->
<script type="text/template" id="addComments-tpl">
    {@if data.isLogin}
        <li class="comment clearfix">
            <a href="//www.imooc.com/u/${data.uid}/articles" target="_blank">
                <div class="head-img l" style="background-image:url(${data.img})"></div>
            </a>
            <div class="comment-detail l">
                <div class="hoverDisplay">
                    <div class="com-author clearfix">
                        {@if data.uid == data.article_uid}
                        <div class="author-mark l"></div>
                        {@/if}
                        <a href="//www.imooc.com/u/${data.uid}/articles" target="_blank">
                            <div class="name l">${data.nickname}</div>
                        </a>
                        {@if data.user_type == 2}
                            <div class="teacher icon l"></div>
                        {@/if}
                        {@if data.is_author == 1}
                            <div class="writer icon l"></div>
                        {@/if}       
                        {@if data.mustar_switch == 1}
                            <div class="user icon l"></div>
                        {@/if}
                        
                    </div>
                    <div class="com-content">
                        $${data.content}
                    </div>
                    <div class="com-other clearfix">
                        <!-- 没点过赞 -->
                        <div class="btn-agree js-agree l" data-commentid="${data.id}">
                            <i class="imv2-thumb_up"></i>
                            <span>${data.support_num}</span>
                        </div>
                        <div class="btn-reply l js-reply" data-replyId="${data.id}">回复</div>
                        <!-- 没登录不显示举报 -->
                        {@if data.isLogin}
                            <div class="btn-report l js-tip-off comment-report" data-id="${data.id}" data-uid="${data.uid}" data-src="${data.tip_url}" data-type="15">举报</div>
                        {@/if}
                        <div class="time r">${data.create_time}</div>
                    </div>
                </div>
            </div>
        </li>
    {@/if}
</script>
<!-- 新增回复和展开三条以外回复 -->
<script type="text/template" id="replys-tpl">
    {@each data.data as it}
        <li class="reply clearfix">
            <a href="//www.imooc.com/u/${it.uid}/articles" target="_blank">
                <div class="head-img l" style="background-image:url(${it.img})"></div>
            </a>
            <div class="reply-detail l">
                <div class="rep-author clearfix">
                    {@if it.uid == data.article_uid}
                    <div class="author-mark l"></div>
                    {@/if}
                    <a href="//www.imooc.com/u/${it.uid}/articles" target="_blank">
                        <div class="name l">${it.nickname}</div>
                    </a>
                    {@if !it.to_nickname}

                        {@if it.user_type == 2}
                            <div class="teacher icon l"></div>
                        {@/if}
                        {@if it.is_author == 1}
                            <div class="writer icon l"></div>
                        {@/if}       
                        {@if it.mustar_switch == 1}
                            <div class="user icon l"></div>
                        {@/if}
                    {@/if}
                    {@if it.to_nickname}
                        <div class="to l clearfix">
                            <span class="l">回复</span>
                            {@if it.to_uid == data.article_uid}
                            <div class="author-mark l"></div>
                            {@/if}
                            <a href="//www.imooc.com/u/${it.father_uid}/articles" target="_blank">
                                <div class="name l">${it.to_nickname}</div>
                            </a>
                        </div>
                    {@/if}
                </div>
                <div class="rep-content">
                    ${it.content}
                </div>
                <div class="rep-other clearfix">
                    <div class="btn-reply l js-reply" data-replyId="${it.id}" data-name="${it.nickname}">回复</div>
                    {@if data.isLogin}
                        <div class="btn-report l js-tip-off reply-report" data-id="${it.id}" data-uid="${it.uid}" data-src="${data.tip_url}" data-type="16">举报</div>
                    {@/if}
                    <div class="time r">${it.create_time}</div>
                </div>
            </div>
        </li>
    {@/each}
</script>
<!-- 立即订阅的弹窗 -->
<script type="text/template" id="buyModal-tpl">
    <div class="js-buyModal buyModal">
        <div class="mask "></div>
        <div class="buyModalContent">
            <div class="img" style="background-image:url(${data.pic})"></div>
            <div class="title">${data.name}</div>
            {@if data.inSale == 1}
                <!-- 有优惠 -->
                <div class="sale-price">
                    限时优惠 ¥ ${data.pay}
                </div>
                <div>
                    <span class="ori">原价 ¥ ${data.ori}</span>
                    <span>${data.recover}</span>
                </div>
            {@else}
                <div class="price">
                    价格 ¥ ${data.ori}
                </div>
            {@/if}
            {@if data.isLogin}
            <a class="gobuy" href="${data.url}" target="_blank">
            {@else}
            <a class="gobuy" href="javascript:;" onclick="$('#js-signin-btn').click();">
            {@/if}
                立即订阅
            </a>
            <div class="close js-close-buyModal">暂不订阅</div>
        </div>
    </div>
</script>

<div class="tipoff-block js-tipoff-block"></div>
<div class="tipoff-box js-tipoff-box">
	<div class="tipoff-top-box clearfix">
		<p class="l tipoff-title">举报</p>
		<span class="r tipoff-close-btn icon-close2 js-tipoff-close"></span>
	</div>
	<div class="tipoff-type-box js-tipoff-typebox clearfix">
		<div class="tipoff-loading">
		  	<div class="bounce1"></div>
			<div class="bounce2"></div>
			<div class="bounce3"></div>
		</div>
	</div>
	<div class="tipoff-content">
		<textarea name="tipoff-content" class="tipoff-desc js-tipoff-desc" placeholder="写下举报理由"></textarea>
		<div class="tipoff-text"><span class="js-tipoff-text">0</span>/150</div>
	</div>
	<div class="tipoff-btn-box clearfix">
		<div class="r tipoff-submit-btn js-tipoff-submit" data-tipofftype="">提交</div>
		<div class="r tipoff-cancel-btn js-tipoff-close">取消</div>
	</div>
</div>





<script>
    var column_id = '47';
    //就是article_id
    var chapter_id = 847;
    var authorId = '8062574';
    // 这是购买弹窗需要的数据
    var pic = '//img4.sycdn.imooc.com/5d634f730001681c05400720.jpg';
    var title = '面试官系统精讲Java源码及大厂真题';
    var inSale = '';
    var pay = '';
    var ori = '';
    var recover = '';
    var url = '';

    // 以下是进入阅读页判断是否合法 需要数据
    var isLogin = 1;
    var canTaste = 0;
    var hasBuy = 1;
    var ifOpen = 0;
    // 举报用 数据
    var tip_url = '/read/47/article/847';

    // 诸葛统计 需要的数据
    var authorName = '文贺';
</script>


</div><script src="./1_files/visual"></script>








<div id="globalRightFloat"></div>






<!--script-->
<script type="text/javascript" src="./1_files/error.js"></script>
<script src="./1_files/ssologin.js"></script>
<script type="text/javascript" src="./1_files/sea.js"></script>
<script type="text/javascript" src="./1_files/sea_config.js"></script>
<script type="text/javascript">seajs.use("/static/page/"+OP_CONFIG.module+"/"+OP_CONFIG.page);</script>

<script type="text/javascript" src="./1_files/dist-zhuge.js"></script>

<script type="text/javascript">seajs.use("/static/page/common/advertiseCheck.js");</script>

<script>
    //动态加载advertisementReportjs

    var checkJQ = function(){
        // console.log(typeof jQuery)
       if(typeof jQuery != 'undefined') {
           clearInterval(timer);
           var scr = document.createElement('script');
           scr.type="text/javascript";
           scr.src="/static/page/common/advertisementReport.js";
           document.body.appendChild(scr);

       }
    }
    var timer = setInterval(checkJQ,1000);

</script>

 
<script src="./1_files/captcha.min.js"></script>
<script type="text/javascript" charset="utf-8" src="./1_files/ueditor.final.min.js"></script>

<script type="text/javascript">
    (function(){
      var imgPic = '//img4.sycdn.imooc.com/5d634f730001681c05400720.jpg',
          text = '05 ArrayList 源码解析和设计思路    | 慕课专栏', //节名称
          url = 'https://www.imooc.com' + window.location.pathname;

      window._bd_share_config = {
          "common": {
              "bdUrl": url,
              "bdSnsKey": {
                'tsina':'2254855082'
              },
              "bdText": text,
              "bdMini": "2",
              "bdMiniList": false,
              "bdPic": imgPic,
              "bdStyle": "0",
              "bdSize": "16"
          },
          "share": {}
      };
      with(document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = '/static/lib/baiduShare/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
    })();
</script>

<script>
	// 处理图片懒加载
	var htmlFilterInterval;
	(function() {
		htmlFilterInterval = setInterval(function() {
			var articleBox = document.getElementById('article_content');
			if(window.$ && $.fn.lazyload && articleBox) {
				clearInterval(htmlFilterInterval);
				htmlFilterInterval = null;
				$(articleBox).replaceWith(articleEl);
				$('img.lazyload').lazyload({
					load: function() {
						$(this).removeClass('lazyload');
					}
				});

                // 20190801优化-左侧菜单处理
                if(sessionStorage.getItem('read_hide_menu') == undefined || sessionStorage.getItem('read_hide_menu') == 0) {
                    $('.sub-header, .main-con').removeClass('hide-menu');
                    $('.js-switch-menu').attr('title', '隐藏目录')
                }
			}
		},5);
	}());
</script>




<div style="display: none">
<script>
(function(){
    console.log('RHKLkaHfEiA,')
    zhuge.identify('RHKLkaHfEiA,')
})()
</script>
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?f0cfcccd7b1393990c78efdeebff3968";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
(function (d) {
window.bd_cpro_rtid="rHT4P1c";
var s = d.createElement("script");s.type = "text/javascript";s.async = true;s.src = location.protocol + "//cpro.baidu.com/cpro/ui/rt.js";
var s0 = d.getElementsByTagName("script")[0];s0.parentNode.insertBefore(s, s0);
})(document);
</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
</div>


<script type="text/javascript" src="./1_files/advertisementReport.js"></script><script src="chrome-extension://lmnganadkecefnhncokdlaohlkneihio/enable.js"></script><script src="chrome-extension://lmnganadkecefnhncokdlaohlkneihio/enable.js"></script><div id="imgPreview" class="imgPreview pngshow" style="height: 240px; width: 360px; margin-left: -180px; margin-top: -120px; display: block;"><img class="nopreview" src="./1_files/5d5fc643000142a403600240.gif"></div><div id="imgPreviewMake" class="imgPreview-make"></div><div id="imgPreviewHandle" class="imgPreviewHandle"><a target="_blank" class="viewOriginalImg" href="./1_files/5d5fc643000142a403600240.gif"><span class="viewOriginalImgText">查看原图</span></a><span class="imgPreview-btn next moco-icon-right" style="display: none;"></span><span class="imgPreview-btn prev moco-icon-left"></span><i title="关闭" class="imgPreview-close moco-icon-close2"></i></div></body></html>